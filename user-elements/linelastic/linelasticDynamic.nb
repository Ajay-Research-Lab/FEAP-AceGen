(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96208,       2432]
NotebookOptionsPosition[     91216,       2334]
NotebookOutlinePosition[     91780,       2353]
CellTagsIndexPosition[     91737,       2350]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q4 element for linear elasticity (small strain - transient)", "Title",
 CellChangeTimes->{{3.8156930094858427`*^9, 3.81569302094204*^9}, {
   3.815693328288763*^9, 3.8156933347842617`*^9}, {3.818339458200585*^9, 
   3.818339460336282*^9}, 3.833164698013917*^9, {3.833206387176962*^9, 
   3.83320639111856*^9}, {3.833246206847639*^9, 3.8332462084631033`*^9}, {
   3.834774373083074*^9, 3.834774378537889*^9}},
 FontSize->18,ExpressionUUID->"64563710-8a1c-4ca3-aa84-b2f18d0cd79e"],

Cell[CellGroupData[{

Cell["A.B. Harish, R.L. Taylor and S. Govindjee", "Subtitle",
 CellChangeTimes->{{3.815693031609951*^9, 3.8156930574078217`*^9}},
 FontSize->18,ExpressionUUID->"7cfc5b2b-cb62-48bf-90c7-5d568d7ac901"],

Cell[TextData[{
 StyleBox["Contact information: ",
  FontWeight->"Bold"],
 "ajaybh@berkeley.edu, rlt@ce.berkeley.edu, s_g@berkeley.edu\n",
 StyleBox["How to cite: ",
  FontWeight->"Bold"],
 "A.B. Harish, R.L. Taylor and S. Govindjee, \[OpenCurlyDoubleQuote]Automated \
Generation of User Elements (UEL) for FEAP,\[CloseCurlyDoubleQuote] SEMM \
Report UCB/SEMM-21/01 (2021)",
 "\n",
 StyleBox["Copyright notice:",
  FontWeight->"Bold"],
 " This work is copyrighted to \[OpenCurlyDoubleQuote]The Regents of the \
University of California\[CloseCurlyDoubleQuote] and is licensed under the \
BSD 3-Clause License. Copyright (c) 2020-2025, The Regents of the University \
of California"
}], "Subsubtitle",
 CellChangeTimes->{{3.815693202350732*^9, 3.815693295243998*^9}, {
   3.815793120739705*^9, 3.815793136446782*^9}, {3.8157931775702057`*^9, 
   3.815793179934222*^9}, 3.8157933186127377`*^9, {3.833164707596266*^9, 
   3.833164707868202*^9}, 3.833206404084943*^9},
 FontSize->18,ExpressionUUID->"35589579-62fe-4820-97ef-3b1b3a6c0d28"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Title",
 CellChangeTimes->{{3.813842184750062*^9, 3.813842202328751*^9}, {
  3.8156933378891087`*^9, 3.815693339462974*^9}},
 FontSize->18,ExpressionUUID->"ae2105f6-22e3-4fc6-a8c7-18940e5d6e3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "AceGen`"}], ";"}]], "Input",
 FontSize->18,
 CellLabel->"In[65]:=",ExpressionUUID->"28ab4327-825f-42ea-8570-27c52a71732c"],

Cell[CellGroupData[{

Cell["User editable quantities", "Subsection",
 CellChangeTimes->{{3.817763659960149*^9, 3.8177636732498093`*^9}, {
  3.817764499265584*^9, 3.817764501170936*^9}, {3.81776484847197*^9, 
  3.817764853677627*^9}},ExpressionUUID->"e7079cb9-11b7-4fe8-9fea-\
d30e2d112d03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"elemname", " ", "=", " ", "\"\<elmt16\>\""}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Element", " ", "name"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"npde", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", 
    RowBox[{"PDE", "'"}], "s"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nelu", " ", "=", " ", 
    RowBox[{"{", "4", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Number", " ", "of", " ", "nodes", " ", "per", " ", "PDE"}], " ", 
    "-", " ", "nelu"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"du", " ", "=", " ", 
    RowBox[{"{", "2", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Number", " ", "of", " ", "dof", " ", "for", " ", "each", " ", "PDE"}], 
    " ", "-", " ", "du"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"elmttype", " ", "=", " ", 
    RowBox[{"{", "\"\<Q1\>\"", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Element", " ", "type"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ndm", " ", "=", " ", "2"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "dimensions"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"nmatdata", " ", "=", " ", "3"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "number", " ", "of", " ", "material", " ", "data"}], 
   " ", "*)"}], "\n", 
  RowBox[{"matdefdata", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"210", "*", 
      RowBox[{"10", "^", "9"}]}], ",", "0.3", ",", "2100"}], "}"}]}], ";", 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "default", " ", "data", " ", "for", " ", "material", " ", "parameters"}], 
   " ", "*)"}], "\n", 
  RowBox[{"properties", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Em - Youngs modulus\>\"", ",", "\"\<\[Nu] - Poisson ratio\>\"", ",", 
     "\"\<\[Rho]0 - Density\>\""}], "}"}]}], ";", " ", 
  RowBox[{"(*", " ", "Properties", " ", "*)"}], "\n", 
  RowBox[{"ngp", " ", "=", " ", "4"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Num", " ", "of", " ", "quadrature", " ", "points"}], " ", "*)"}], 
  "\n", 
  RowBox[{"hist1", " ", "=", " ", "0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Num", " ", "of", " ", "history", " ", 
     RowBox[{"variables", ":", " ", 
      RowBox[{"Time", "-", "independent"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "nh1"}], "/", "nh2"}]}], " ", "*)"}], 
  "\n", 
  RowBox[{"hist3", " ", "=", " ", "0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Num", " ", "of", " ", "history", " ", 
     RowBox[{"variables", ":", " ", 
      RowBox[{"Time", "-", "dependent"}]}]}], ",", " ", 
    RowBox[{"i", ".", "e", ".", " ", "nh3"}]}], " ", "*)"}], "\n", 
  RowBox[{"Tangissymmetric", " ", "=", " ", "False"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Is", " ", "tangent", " ", 
    RowBox[{"symmetric", "?", " ", "True"}], " ", "or", " ", "False"}], " ", 
   "*)"}]}]}], "Code",
 CellChangeTimes->{{3.817763680978793*^9, 3.817763689299687*^9}, {
   3.8177637275396967`*^9, 3.817763744078885*^9}, {3.817763790495373*^9, 
   3.817763816183858*^9}, {3.817763857063754*^9, 3.817763889060898*^9}, {
   3.817763969921926*^9, 3.8177640233093576`*^9}, {3.817764075407661*^9, 
   3.817764108073941*^9}, {3.817764193624531*^9, 3.817764193876842*^9}, {
   3.817764227826687*^9, 3.817764235236465*^9}, {3.817764279230935*^9, 
   3.817764397818592*^9}, {3.817764458510601*^9, 3.817764482229937*^9}, 
   3.817764513292523*^9, {3.8177647586687727`*^9, 3.8177647979994707`*^9}, 
   3.8177648925790987`*^9, {3.817765066036697*^9, 3.817765114230732*^9}, {
   3.81777610157003*^9, 3.817776128645686*^9}, {3.8177761745761967`*^9, 
   3.817776192078064*^9}, {3.81778825836509*^9, 3.8177882727730207`*^9}, {
   3.817788384917109*^9, 3.8177883884393873`*^9}, 3.8177886167634172`*^9, {
   3.817820400946322*^9, 3.8178204445180683`*^9}, 3.817820493032778*^9, {
   3.8178244285607452`*^9, 3.817824432968463*^9}, {3.817824473981532*^9, 
   3.8178244862040453`*^9}, 3.817843755884407*^9, {3.819396582952609*^9, 
   3.819396589967366*^9}, {3.8197378768660316`*^9, 3.819737894955821*^9}, {
   3.8199991525082903`*^9, 3.8199991537371187`*^9}, 3.820086062795796*^9, {
   3.832946305911119*^9, 3.8329463059515953`*^9}, {3.833164325824317*^9, 
   3.833164326132267*^9}, {3.833164503971287*^9, 3.833164517469021*^9}, {
   3.83316607794308*^9, 3.833166087177402*^9}, {3.833206420299161*^9, 
   3.833206506975813*^9}, 3.833246212588908*^9, {3.8332478134283447`*^9, 
   3.8332478292745237`*^9}},
 FontSize->18,
 CellLabel->"In[66]:=",ExpressionUUID->"5b6d2078-2e34-4938-bd9c-1e1d63644703"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derived quantities (Do not modify)", "Subsection",
 CellChangeTimes->{{3.817764336398464*^9, 3.8177643389446898`*^9}, {
  3.817764487943778*^9, 
  3.817764492304883*^9}},ExpressionUUID->"fe9279c1-0aaf-4af4-81ee-\
1654b90fb8f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nst", " ", "=", " ", 
    RowBox[{"nelu", ".", "du"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Size", " ", "of", " ", "stiffness", " ", "matrix"}], " ", 
   "*)"}]}]], "Code",
 CellChangeTimes->{
  3.817764347169118*^9, {3.8197379072542753`*^9, 3.819737920690544*^9}, {
   3.83316609615107*^9, 3.833166096464794*^9}},
 FontSize->18,
 CellLabel->"In[73]:=",ExpressionUUID->"93578910-7505-4ecc-a55a-0f3f8ffe409d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Datarules (Do not modify)", "Subsection"]], "Section",
 CellChangeTimes->{{3.81561780368813*^9, 3.815617805314941*^9}, {
  3.817764856650588*^9, 3.81776486081748*^9}},
 FontSize->18,ExpressionUUID->"6d3af47e-d1b5-4998-a355-fee1f44f1df7"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{
    "Mapping", " ", "between", " ", "AceGen", " ", "and", " ", "FEAP", " ", 
     "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"datarules", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"es$$", "[", 
         RowBox[{"\"\<Data\>\"", ",", "i_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"d$$", "[", "i", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nd$$", "[", 
         RowBox[{"i_", ",", "\"\<X\>\"", ",", "j_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"xl$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nd$$", "[", 
         RowBox[{"i_", ",", "\"\<at\>\"", ",", "j_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"ul$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s$$", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"s$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"c$$", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"c$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m$$", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"m$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p$$", "[", "i_", "]"}], "\[RuleDelayed]", 
        RowBox[{"p$$", "[", "i", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ed$$", "[", 
         RowBox[{"\"\<ht\>\"", ",", "i_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"ht$$", "[", "i", "]"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ed$$", "[", 
         RowBox[{"\"\<hp\>\"", ",", "i_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"hp$$", "[", "i", "]"}]}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"es$$", "[", 
         RowBox[{"\"\<IntPoints\>\"", ",", "i_", ",", "j_"}], "]"}], 
        "\[RuleDelayed]", 
        RowBox[{"gp$$", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"es$$", "[", 
         RowBox[{"\"\<id\>\"", ",", "\"\<NoIntPoints\>\""}], "]"}], 
        "\[RuleDelayed]", "ngpo$$"}]}], "}"}]}], ";"}]}],
  FontSize->18]], "Code",
 CellChangeTimes->{{3.815617834372999*^9, 3.815617880081501*^9}, {
   3.815618316391011*^9, 3.81561832165723*^9}, {3.8156939877157803`*^9, 
   3.8156940174012213`*^9}, 3.815697942770464*^9, {3.815703385982888*^9, 
   3.815703392672761*^9}, 3.815799984220977*^9, {3.815800227492919*^9, 
   3.81580028294464*^9}, {3.815800426479012*^9, 3.8158004504937067`*^9}, {
   3.816215988982153*^9, 3.816216019947084*^9}, 3.816216079657776*^9, {
   3.817763996346162*^9, 3.8177639978699102`*^9}, {3.8177648699397383`*^9, 
   3.8177648724010057`*^9}},
 FontSize->18,
 CellLabel->"In[74]:=",ExpressionUUID->"74aecf2e-b33b-468c-84f2-00e88b04518f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization (Do not modify)", "Section",
 CellChangeTimes->{{3.8138422207483377`*^9, 3.813842227213697*^9}, {
  3.818338175451398*^9, 3.818338178959013*^9}},
 FontSize->18,ExpressionUUID->"8ab5073c-1a9a-42f8-8a12-b859b69c83b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SMSInitialize", "[", 
   RowBox[{"elemname", ",", 
    RowBox[{"\"\<Environment\>\"", "->", "\"\<User\>\""}], ",", 
    RowBox[{"\"\<Language\>\"", "\[Rule]", "\"\<Fortran\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSTemplate", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Element", " ", "Topology"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"\"\<SMSTopology\>\"", "\[Rule]", " ", 
     RowBox[{
     "elmttype", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSSymmetricTangent\>\"", "\[Rule]", "Tangissymmetric"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSDomainDataNames\>\"", "\[Rule]", " ", "properties"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSDefaultData\>\"", " ", "\[Rule]", " ", "matdefdata"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSUserDataRules\>\"", "\[Rule]", "datarules"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.813842248964122*^9, 3.81384227748343*^9}, 
   3.8138432700597343`*^9, {3.814028909598077*^9, 3.814028916615013*^9}, {
   3.814132879109413*^9, 3.814132880164461*^9}, {3.814133627592999*^9, 
   3.814133627955427*^9}, {3.814569078254141*^9, 3.8145691351173058`*^9}, {
   3.814761756733983*^9, 3.814761759374629*^9}, {3.815240048166686*^9, 
   3.8152400482847357`*^9}, {3.815618332406465*^9, 3.8156183647483177`*^9}, {
   3.815693946211104*^9, 3.815693974754772*^9}, {3.815697954780087*^9, 
   3.81569797274841*^9}, {3.81570242323962*^9, 3.81570242683922*^9}, {
   3.8157033959581537`*^9, 3.815703401989698*^9}, {3.81570349665481*^9, 
   3.815703502862294*^9}, {3.815794974199542*^9, 3.81579497451021*^9}, {
   3.815795349061489*^9, 3.815795386287609*^9}, {3.815977963193828*^9, 
   3.815977965765276*^9}, {3.816030239109639*^9, 3.816030240197155*^9}, {
   3.8160370129154453`*^9, 3.8160370236879168`*^9}, {3.8160370850641727`*^9, 
   3.8160370853097153`*^9}, {3.816216121435235*^9, 3.816216149981251*^9}, {
   3.817764728716057*^9, 3.817764730050263*^9}, {3.817764818456066*^9, 
   3.8177648202729797`*^9}, {3.817765018250526*^9, 3.817765056808091*^9}, 
   3.817765101978568*^9, 3.8177761097270927`*^9, {3.8177761571461277`*^9, 
   3.817776160370899*^9}, {3.817776199583419*^9, 3.817776206823043*^9}, {
   3.817788278519973*^9, 3.8177882796271553`*^9}, {3.8178181964337606`*^9, 
   3.817818202522172*^9}, {3.8193965954794207`*^9, 3.819396601531494*^9}},
 FontSize->18,
 CellLabel->"In[75]:=",ExpressionUUID->"c192d2a7-c89d-4ee8-9a9a-f50f7a60f08e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Element definition: Kinematical quantities (User modifiable)", "Section",
 CellChangeTimes->{{3.8138423070170813`*^9, 3.813842320200165*^9}, {
  3.81833818738752*^9, 3.818338191328669*^9}},
 FontSize->18,ExpressionUUID->"ce1b9402-a5f4-4d56-a343-7b0d4df54d0b"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"ElementDefinitions01", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Get", " ", "the", " ", "input", " ", "data"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Em", ",", "\[Nu]", ",", "\[Rho]0"}], "}"}], "\[RightTee]", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"es$$", "[", 
           RowBox[{"\"\<Data\>\"", ",", "i"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "SMSDomainDataNames", "]"}]}], "}"}]}], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Reference", " ", "coordinates"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"XI", "\[RightTee]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SMSReal", "[", 
           RowBox[{"nd$$", "[", 
            RowBox[{"i", ",", "\"\<X\>\"", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "SMSNoDimensions"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
            "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Get", " ", "the", " ", "full", " ", "displacemnets", " ", "and", " ", 
        "pressures"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"uI", "\[RightTee]", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"SMSReal", "[", 
           RowBox[{"nd$$", "[", 
            RowBox[{"i", ",", "\"\<at\>\"", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nst"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Split", " ", "into", " ", "displacements"}], ",", " ", 
        RowBox[{
        "velocities", " ", "and", " ", "accelerations", " ", "for", " ", 
         "u"}]}], " ", "*)"}], "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Follow", " ", "this", " ", "for", " ", "any", " ", "new", " ", 
        "vector", " ", 
        RowBox[{"quantit", "i", "es"}]}], " ", "*)"}], "\n", 
      RowBox[{"uT", "\[RightTee]", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"uI", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", " ", ";;", " ", 
               RowBox[{
                RowBox[{
                "nelu", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "du", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], ",", "1"}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "du", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"vT", "\[RightTee]", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"uI", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", " ", ";;", " ", 
               RowBox[{
                RowBox[{
                "nelu", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "du", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], ",", "4"}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "du", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"aT", "\[RightTee]", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"uI", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", " ", ";;", " ", 
               RowBox[{
                RowBox[{
                "nelu", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "du", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], ",", "5"}], "]"}], "]"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "du", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "}"}]}], "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Define", " ", "flattened", " ", "vectors", " ", "for", " ", "all", 
        " ", "u"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pu", " ", "=", " ", 
       RowBox[{"Flatten", "[", "uT", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pv", " ", "=", " ", 
       RowBox[{"Flatten", "[", "vT", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pa", " ", "=", " ", 
       RowBox[{"Flatten", "[", "aT", "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"Join", " ", "all", " ", "vectors"}], "*)"}], "\n", 
      RowBox[{"ppf", "=", "pu"}], ";", "\n", 
      RowBox[{"ppvf", "=", "pv"}], ";", "\n", 
      RowBox[{"ppaf", "=", "pa"}], ";"}], "\n", ")"}]}],
   FontSize->16], 
  StyleBox[";",
   FontSize->18]}]], "Code",
 CellChangeTimes->{
  3.818338275525951*^9, {3.8183383291148043`*^9, 3.8183384077502832`*^9}, {
   3.8183384425994463`*^9, 3.818338456178877*^9}, {3.818338714120408*^9, 
   3.818338875687351*^9}, {3.8183390744404707`*^9, 3.818339127016461*^9}, {
   3.81833971627389*^9, 3.818339777417438*^9}, {3.8183398120253067`*^9, 
   3.818339849865715*^9}, {3.818775001751857*^9, 3.818775005997861*^9}, 
   3.818781057844462*^9, {3.818783041728911*^9, 3.818783044859013*^9}, {
   3.818785383475432*^9, 3.818785387861189*^9}, {3.819051782604725*^9, 
   3.81905179271446*^9}, {3.81951458237927*^9, 3.819514600402841*^9}, {
   3.819737942064724*^9, 3.819737943647276*^9}, {3.8197498343892813`*^9, 
   3.8197499202208977`*^9}, {3.8332065300234947`*^9, 
   3.8332065475688133`*^9}, {3.833243734859187*^9, 3.833243740419909*^9}, {
   3.833247806577682*^9, 3.833247806722871*^9}, {3.8334029948606358`*^9, 
   3.833402997272648*^9}},
 FontSize->18,ExpressionUUID->"ce4777e9-97e5-4f34-8348-4ca5fa01b98d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Element definition: Interpolation of positions & pressures (User modifiable)\
\>", "Section",
 CellChangeTimes->{{3.813842985505456*^9, 3.813842995805217*^9}, {
  3.813843346742887*^9, 3.813843348174974*^9}, {3.813848474678171*^9, 
  3.8138484765183887`*^9}, {3.819054378360196*^9, 3.819054387812419*^9}},
 FontSize->18,ExpressionUUID->"094f8ccb-e91a-4ef8-845f-4f46d45fef89"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ElementDefinitions03", "[", "]"}], ":=", 
    RowBox[{"(", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Initialize", " ", "variable", " ", "for", " ", "Guass", " ", 
       "quadrature", " ", "points"}], " ", "*)"}], "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], 
       "\[RightTee]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SMSReal", "[", 
          RowBox[{"es$$", "[", 
           RowBox[{"\"\<IntPoints\>\"", ",", "i", ",", "Ig"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SMSNoDimensions", "\[Equal]", "2"}], ",", " ", 
        RowBox[{"\[CapitalXi]", "=", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}]}], ",", " ", 
        RowBox[{"\[CapitalXi]", "=", 
         RowBox[{"{", 
          RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Define", " ", "the", " ", "weights", " ", "of", " ", "the", " ", 
        "integration", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"wgp", "\[RightTee]", 
       RowBox[{"SMSReal", "[", 
        RowBox[{"es$$", "[", 
         RowBox[{"\"\<IntPoints\>\"", ",", "4", ",", "Ig"}], "]"}], "]"}]}], 
      ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Get", " ", "the", " ", "shape", " ", "functions", " ", "for", " ", 
          "disp", "  ", 
          RowBox[{"d", ".", "o", ".", "f"}]}], " ", "&"}], " ", 
        "coordinates"}], "*)"}], "\n", 
      RowBox[{"Nhu", "\[DoubleRightTee]", 
       RowBox[{"NormalShapeFunction", "[", 
        RowBox[{
        "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Define", " ", "coordinates", " ", "at", " ", "the", " ", "Gauss", " ",
         "point"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"X", "\[RightTee]", 
       RowBox[{"SMSFreeze", "[", 
        RowBox[{"Nhu", ".", "XI"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "the", " ", "Jacobian"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"JX", "\[DoubleRightTee]", 
       RowBox[{"SMSD", "[", 
        RowBox[{"X", ",", "\[CapitalXi]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Determinant", " ", "of", " ", "Jacobian"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"JXd", "\[DoubleRightTee]", 
       RowBox[{"Det", "[", "JX", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Get", " ", 
        RowBox[{
         RowBox[{"disp", "/", "vel"}], "/", "acc"}], " ", "at", " ", "the", 
        " ", "Gauss", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"u", "\[RightTee]", 
       RowBox[{"SMSFreeze", "[", 
        RowBox[{"Nhu", ".", "uT"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "\[RightTee]", 
       RowBox[{"SMSFreeze", "[", 
        RowBox[{"Nhu", ".", "vT"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "\[RightTee]", 
       RowBox[{"SMSFreeze", "[", 
        RowBox[{"Nhu", ".", "aT"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Get", " ", "the", " ", "variation", " ", "of", " ", "u", " ", "and", 
        " ", "p"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Delta]u", "\[RightTee]", 
       RowBox[{"SMSD", "[", 
        RowBox[{"u", ",", "pu"}], "]"}]}], ";"}], "\n", ")"}]}], ";"}],
  FontSize->16]], "Code",
 CellChangeTimes->{
  3.818339214434651*^9, {3.818339603249341*^9, 3.818339630100668*^9}, {
   3.818775037044373*^9, 3.8187750476346197`*^9}, 3.8187810458388367`*^9, {
   3.818783054851685*^9, 3.818783059826701*^9}, {3.818784425561349*^9, 
   3.818784436398364*^9}, {3.818784992723535*^9, 3.818785044324133*^9}, {
   3.818785201800655*^9, 3.818785222285486*^9}, {3.81878529212002*^9, 
   3.8187853074879503`*^9}, {3.818785412342087*^9, 3.818785429610116*^9}, 
   3.818785572922229*^9, 3.8187863940776377`*^9, {3.818790888961934*^9, 
   3.818790889263977*^9}, {3.8187910132683992`*^9, 3.818791027503562*^9}, {
   3.818792101886632*^9, 3.818792107821628*^9}, {3.8187922521925087`*^9, 
   3.818792253252653*^9}, {3.818793401842156*^9, 3.818793431856124*^9}, {
   3.8187938225975647`*^9, 3.81879382963235*^9}, {3.81879475917099*^9, 
   3.818794759543043*^9}, {3.818794871715115*^9, 3.8187948734650393`*^9}, {
   3.818795278016767*^9, 3.818795290905354*^9}, {3.818795514210051*^9, 
   3.818795517644412*^9}, {3.818795802890965*^9, 3.8187958331622066`*^9}, {
   3.818795922407455*^9, 3.818795924302434*^9}, {3.819044604698105*^9, 
   3.819044632977293*^9}, {3.819050497865294*^9, 3.819050501659548*^9}, {
   3.81905056395687*^9, 3.8190506667408743`*^9}, {3.819050736658959*^9, 
   3.819050755377761*^9}, {3.8190507923507957`*^9, 3.8190508265076036`*^9}, {
   3.819051806202482*^9, 3.819051814777501*^9}, {3.819054399714272*^9, 
   3.819054417334169*^9}, {3.819749926629661*^9, 3.819749933821497*^9}, {
   3.8332065684050303`*^9, 3.833206581134984*^9}, {3.8332431910880537`*^9, 
   3.83324319163099*^9}, {3.833403238687742*^9, 3.8334032402283497`*^9}},
 FontSize->18,ExpressionUUID->"6d8458d0-9e5a-4140-a3ed-82c4c3116bf7"],

Cell[CellGroupData[{

Cell["Shape functions (Do not modify)", "Subsection",
 CellChangeTimes->{{3.818793441611081*^9, 3.818793442107314*^9}, {
  3.8187959538459253`*^9, 
  3.8187959598754053`*^9}},ExpressionUUID->"ab069be5-e32a-4d21-ba40-\
b402d2ba8a9b"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NormalShapeFunction", "[", "nel_", "]"}],
   FontSize->16], 
  StyleBox[":=",
   FontSize->16], 
  StyleBox["\n",
   FontSize->16], 
  RowBox[{
   StyleBox["If",
    FontSize->16], 
   StyleBox["[",
    FontSize->16], 
   RowBox[{
    RowBox[{
     StyleBox["ndm",
      FontSize->16], 
     StyleBox["\[Equal]",
      FontSize->16], "2"}], ",", 
    StyleBox["\n",
     FontSize->16], 
    RowBox[{
     StyleBox["Switch",
      FontSize->16], 
     StyleBox["[",
      FontSize->16], 
     RowBox[{
      StyleBox["nel",
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], "\t", "3", ",", "\n", "\t", 
      StyleBox[
       RowBox[{"Nh", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}], ",", "\[Xi]", ",", 
          "\[Eta]"}], "}"}]}],
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], "\t", "4", 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->18], "\t", 
      StyleBox[
       RowBox[{"Nh", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}]}]}], "}"}]}],
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], 
      StyleBox["\t",
       FontSize->16], 
      StyleBox["6",
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], 
      StyleBox["\t",
       FontSize->16], 
      StyleBox[
       RowBox[{"Nh", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"0.5", "-", "\[Xi]", "-", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{"2", "\[Xi]", 
           RowBox[{"(", 
            RowBox[{"\[Xi]", "-", "0.5"}], ")"}]}], ",", 
          RowBox[{"2", "\[Eta]", 
           RowBox[{"(", 
            RowBox[{"\[Eta]", "-", "0.5"}], ")"}]}], ",", 
          RowBox[{"4", "\[Xi]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{"4", "\[Xi]", "*", "\[Eta]"}], ",", 
          RowBox[{"4", "\[Eta]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}], ")"}]}]}], "}"}]}],
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], 
      StyleBox["\t",
       FontSize->16], "8", 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], 
      StyleBox["\t",
       FontSize->16], 
      StyleBox[
       RowBox[{"Nh", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]", "+", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]", "+", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]}], ",", "\n", "\t", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "4"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Xi]", "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Eta]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Eta]"}], ")"}]}]}], "}"}]}],
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], "\t", "9", 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], 
      StyleBox["\t",
       FontSize->16], 
      StyleBox[
       RowBox[{"Nh", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Xi]", "^", "2"}], "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eta]", "^", "2"}], "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Xi]", "^", "2"}], "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eta]", "^", "2"}], "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Xi]", "^", "2"}], "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eta]", "^", "2"}], "+", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "4"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Xi]", "^", "2"}], "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eta]", "^", "2"}], "+", "\[Eta]"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Xi]", "^", "2"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eta]", "^", "2"}], "-", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Xi]", "^", "2"}], "+", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Xi]", "^", "2"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eta]", "^", "2"}], "+", "\[Eta]"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Xi]", "^", "2"}], "-", "\[Xi]"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Xi]", "^", "2"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}]}], "}"}]}],
       FontSize->16]}], 
     StyleBox["]",
      FontSize->16]}], 
    StyleBox[",",
     FontSize->16], "\n", 
    RowBox[{
     StyleBox["Switch",
      FontSize->16], 
     StyleBox["[",
      FontSize->16], 
     RowBox[{
      StyleBox["nel",
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], "\t", 
      StyleBox["4",
       FontSize->16], 
      StyleBox[",",
       FontSize->16], 
      StyleBox["\n",
       FontSize->16], "\t", 
      RowBox[{"Nh", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], ",", 
         "\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}], ",", "\n", "\t", 
      "8", ",", "\n", "\t", 
      RowBox[{"Nh", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}]}], "}"}]}], ",", "\n", "\t",
       "10", ",", "\n", "\t", 
      RowBox[{"Nh", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
              ")"}]}], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{"\[Xi]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "\[Xi]"}], "-", "1"}], ")"}]}], ",", 
         RowBox[{"\[Eta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "\[Eta]"}], "-", "1"}], ")"}]}], ",", 
         RowBox[{"\[Zeta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "\[Zeta]"}], "-", "1"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{"4", "\[Xi]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{"4", "\[Xi]", "*", "\[Eta]"}], ",", 
         RowBox[{"4", "\[Eta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{"4", "\[Zeta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{"4", "\[Xi]", "*", "\[Zeta]"}], ",", 
         RowBox[{"4", "*", "\[Eta]", "*", "\[Zeta]"}]}], "}"}]}], ",", "\n", 
      "\t", "20", ",", "\n", "\t", 
      RowBox[{"Nh", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "+", "\[Xi]", "+", "\[Eta]", "+", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "-", "\[Xi]", "+", "\[Eta]", "+", "\[Zeta]"}], 
           ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "-", "\[Xi]", "-", "\[Eta]", "+", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "+", "\[Xi]", "-", "\[Eta]", "+", "\[Zeta]"}], 
           ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "+", "\[Xi]", "+", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "-", "\[Xi]", "+", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "-", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "1"}], "/", "8"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"2", "+", "\[Xi]", "-", "\[Eta]", "-", "\[Zeta]"}], 
           ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", "\n", "\t", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"1", "/", "4"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Xi]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Zeta]"}], ")"}]}]}], "}"}]}]}], "]"}]}], 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.818793454292728*^9, 3.8187934559093246`*^9}, {
   3.8187934879764957`*^9, 3.818793491956821*^9}, {3.818793523337132*^9, 
   3.818793524817842*^9}, {3.818793601370133*^9, 3.8187936708333387`*^9}, {
   3.81879372015727*^9, 3.8187938097569036`*^9}, 3.8187945683773317`*^9, {
   3.818794751723723*^9, 3.818794756284726*^9}, {3.818795294618606*^9, 
   3.818795295270487*^9}, 3.8187957973693123`*^9, {3.819044770893375*^9, 
   3.819044889731832*^9}, {3.819044969622436*^9, 3.819045049737761*^9}, {
   3.8190452933984118`*^9, 3.8190453386559267`*^9}, {3.819045393631422*^9, 
   3.819045422789454*^9}, {3.819049096382326*^9, 3.819049097941985*^9}, {
   3.819049280714621*^9, 3.819049301335102*^9}, {3.819049340968988*^9, 
   3.819049348958378*^9}, {3.819049517936928*^9, 3.81905007473921*^9}, {
   3.819050111686248*^9, 3.819050136041771*^9}, {3.81905017845187*^9, 
   3.819050248632436*^9}, {3.8190503249494677`*^9, 3.819050365628458*^9}, {
   3.819050429565774*^9, 3.819050456419189*^9}, {3.8190517750896072`*^9, 
   3.819051777237287*^9}, {3.819051890444364*^9, 3.81905191352274*^9}, {
   3.8190519981887608`*^9, 3.819052246062293*^9}, {3.819053152814413*^9, 
   3.819053187326042*^9}, {3.819053302663864*^9, 3.819053423486065*^9}, {
   3.819053919279818*^9, 3.819053933814369*^9}, {3.819054010421732*^9, 
   3.819054020973712*^9}, {3.819054082229741*^9, 3.819054089160129*^9}, {
   3.81905413740114*^9, 3.819054164051155*^9}, {3.81999899787374*^9, 
   3.819999003632331*^9}},
 FontSize->18,
 CellLabel->"In[79]:=",ExpressionUUID->"dde91a87-c570-4878-ab7e-5f79f3886c6d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variations, gradient, strain and stress (User defined)", "Section",
 CellChangeTimes->{{3.813848418111809*^9, 3.813848421395294*^9}, {
  3.81387340600445*^9, 3.81387341485361*^9}, {3.818339648471862*^9, 
  3.818339652204544*^9}},
 FontSize->18,ExpressionUUID->"1c38b0e5-ec87-488e-8aa9-5e8a4a423d41"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox[
    RowBox[{"ElementDefinitions04", "[", "]"}],
    FontSize->16], 
   StyleBox[":=",
    FontSize->16], 
   RowBox[{
    StyleBox["(",
     FontSize->16], 
    StyleBox["\[IndentingNewLine]",
     FontSize->16], 
    StyleBox[
     RowBox[{"(*", " ", 
      RowBox[{"Displacement", " ", "gradient"}], " ", "*)"}],
     FontSize->16], 
    StyleBox["\[IndentingNewLine]",
     FontSize->16], 
    RowBox[{
     StyleBox[
      RowBox[{"Du", "\[DoubleRightTee]", 
       RowBox[{"SMSD", "[", 
        RowBox[{"u", ",", "X", ",", 
         RowBox[{"\"\<Dependency\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[CapitalXi]", ",", "X", ",", 
            RowBox[{"SMSInverse", "[", "JX", "]"}]}], "}"}]}]}], "]"}]}],
      FontSize->16], 
     StyleBox[";",
      FontSize->16], 
     StyleBox["\[IndentingNewLine]",
      FontSize->16], 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{"Small", " ", "strain"}], " ", "*)"}],
      FontSize->16], 
     StyleBox["\[IndentingNewLine]",
      FontSize->16], 
     StyleBox[
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"\[Epsilon]", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Du", "+", 
           RowBox[{"Transpose", "[", "Du", "]"}]}], ")"}], "/", "2"}], ",", 
        RowBox[{"\"\<KeepStructure\>\"", "\[Rule]", "True"}]}], "]"}],
      FontSize->16], 
     StyleBox[";",
      FontSize->16], 
     StyleBox["\n",
      FontSize->16], 
     RowBox[{"(*", 
      StyleBox[" ",
       FontSize->16], 
      StyleBox[
       RowBox[{"Lame", " ", "constant"}],
       FontSize->16], 
      StyleBox[" ",
       FontSize->16], "*)"}], 
     StyleBox["\n",
      FontSize->16], 
     StyleBox[
      RowBox[{"\[Mu]", "\[DoubleRightTee]", 
       RowBox[{"Em", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Nu]"}], ")"}]}], ")"}]}]}],
      FontSize->16], 
     StyleBox[";",
      FontSize->16], 
     StyleBox["\n",
      FontSize->16], 
     RowBox[{
      StyleBox["\[Lambda]",
       FontSize->16], "\[DoubleRightTee]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Em", "*", "\[Nu]"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Nu]"}], ")"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "*", "\[Nu]"}]}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{"Calculate", " ", "the", " ", "volumetric", " ", "strain"}], 
       " ", "*)"}],
      FontSize->16], "\n", 
     StyleBox[
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"\[Theta]", ",", 
        RowBox[{
         RowBox[{"\[Epsilon]", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
         RowBox[{"\[Epsilon]", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "]"}],
      FontSize->16], 
     StyleBox[";",
      FontSize->16], "\n", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Calculate", " ", "the", " ", "stress"}],
       FontSize->16], "*)"}], 
     StyleBox["\[IndentingNewLine]",
      FontSize->16], 
     RowBox[{"sig0", "\[DoubleRightTee]", 
      RowBox[{"\[Lambda]", "*", "\[Theta]"}]}], ";", "\n", 
     RowBox[{"sig2", "\[DoubleRightTee]", 
      RowBox[{
       RowBox[{"2", "*", "\[Mu]", "*", "\[Epsilon]"}], "+", 
       RowBox[{"sig0", "*", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Convert", " ", "to", " ", "voigt", " ", "notation"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"sigv", "\[DoubleRightTee]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sig2", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"sig2", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"sig2", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Form", " ", "the", " ", "B"}], "-", "matrix"}], " ", "*)"}],
      FontSize->16], 
     StyleBox["\[IndentingNewLine]",
      FontSize->16], 
     StyleBox[
      RowBox[{"\[Epsilon]2", "\[DoubleRightTee]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"\[Epsilon]", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "}"}]}],
      FontSize->16], 
     StyleBox[";",
      FontSize->16], 
     StyleBox["\[IndentingNewLine]",
      FontSize->16], 
     StyleBox[
      RowBox[{"\[Delta]\[Epsilon]", "\[DoubleRightTee]", 
       RowBox[{"SMSD", "[", 
        RowBox[{"\[Epsilon]2", ",", "pu"}], "]"}]}],
      FontSize->16], 
     StyleBox[";",
      FontSize->16]}], 
    StyleBox["\[IndentingNewLine]",
     FontSize->16], 
    StyleBox[")",
     FontSize->16]}]}], 
  StyleBox[";",
   FontSize->16]}]], "Code",
 CellChangeTimes->{
  3.81833923653438*^9, {3.818780752216251*^9, 3.818780754778165*^9}, {
   3.8187830661082067`*^9, 3.8187830733006496`*^9}, 3.833206643269664*^9, {
   3.8332437599666224`*^9, 3.833243915174836*^9}, {3.833247624703437*^9, 
   3.833247656502399*^9}, 3.83340350453456*^9},
 FontSize->18,ExpressionUUID->"4fb3fc8d-4150-49ed-9830-4e1f59efd1c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Terms for the residual (Define the terms in the weak form) (User modifiable)\
\>", "Section",
 CellChangeTimes->{{3.813873455337729*^9, 3.81387348452664*^9}, {
  3.818339654274866*^9, 3.8183396635146437`*^9}, {3.819054537508341*^9, 
  3.81905454232012*^9}},
 FontSize->18,ExpressionUUID->"0074e2a8-42bf-4549-b46e-910e7e90962c"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
    RowBox[{"ElementDefinitions05", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", " ", "\[DoubleRightTee]", 
       RowBox[{"\[Rho]0", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Transpose", "[", "\[Delta]u", "]"}], ".", "a"}], ")"}]}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "\[DoubleRightTee]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Transpose", "[", "\[Delta]\[Epsilon]", "]"}], ".", "sigv"}],
         ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Weakform", "\[DoubleRightTee]", 
       RowBox[{"T1", "+", "T2"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], 
   ";"}],
  FontSize->16]], "Code",
 CellChangeTimes->{
  3.81833925499399*^9, {3.818339668899283*^9, 3.818339688731236*^9}, {
   3.8187807429125977`*^9, 3.8187807455645227`*^9}, {3.8187830768503838`*^9, 
   3.818783078137409*^9}, {3.8332431372513227`*^9, 3.833243159901474*^9}, {
   3.83324767071382*^9, 3.833247681805964*^9}},
 FontSize->18,
 CellLabel->"In[81]:=",ExpressionUUID->"deffe977-de30-4b8b-b057-1dfc8591b4f6"],

Cell[CellGroupData[{

Cell["Call for all the user definitions (User modifiable)", "Subsection",
 CellChangeTimes->{{3.818339323425056*^9, 3.818339340197098*^9}, {
  3.819054531300694*^9, 
  3.8190545315557547`*^9}},ExpressionUUID->"5cc5b2e5-9747-4eae-b459-\
9eb8f22e836a"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", " ", 
    RowBox[{
    "List", " ", "all", " ", "the", " ", "element", " ", "definitions", " ", 
     "that", " ", "need", " ", "to", " ", "be", " ", "used"}], " ", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ElementDefinitions", "[", "]"}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ElementDefinitions01", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ElementDefinitions03", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ElementDefinitions04", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ElementDefinitions05", "[", "]"}], ";"}], 
      "\[IndentingNewLine]", ")"}]}], ";"}]}],
  FontSize->16]], "Code",
 CellChangeTimes->{{3.818339343757535*^9, 3.818339355472116*^9}, {
   3.8183398760992117`*^9, 3.818339887905892*^9}, {3.818780452847699*^9, 
   3.818780454945815*^9}, 3.818781073822852*^9, {3.8187830809761972`*^9, 
   3.8187830837966127`*^9}, {3.818790907408527*^9, 3.8187909075363197`*^9}},
 FontSize->18,
 CellLabel->"In[82]:=",ExpressionUUID->"b077288f-0e29-4c2f-a905-c8509a35b19a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Datarules for isw = 1 (No not modify)", "Subsection",
 CellChangeTimes->{{3.8178177251444197`*^9, 3.8178177359431133`*^9}, {
  3.817844277380761*^9, 
  3.817844290922632*^9}},ExpressionUUID->"8b854d03-5ba4-4f60-9af8-\
010ee0e7c1e8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SMSModule", "[", 
   RowBox[{
    RowBox[{"elemname", "<>", "\"\<_ISW01\>\""}], ",", 
    RowBox[{"Integer", "[", 
     RowBox[{"npde$$", ",", 
      RowBox[{"du$$", "[", "10", "]"}], ",", 
      RowBox[{"nelu$$", "[", "10", "]"}], ",", "hist1$$", ",", "hist3$$"}], 
     "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"npde", ",", "npde$$"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"du", ",", "du$$"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"nelu", ",", "nelu$$"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"hist1", ",", "hist1$$"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"hist3", ",", "hist3$$"}], "]"}], ";"}]}], "Code",
 CellChangeTimes->{{3.8178178825457573`*^9, 3.81781788528594*^9}, {
   3.817817981751343*^9, 3.81781798445*^9}, {3.817818041466187*^9, 
   3.817818067999732*^9}, {3.8178180996676607`*^9, 3.8178181294896708`*^9}, {
   3.8178183396758223`*^9, 3.8178183597509613`*^9}, {3.8178205082562227`*^9, 
   3.8178205396702642`*^9}, {3.817843346201322*^9, 3.817843380539229*^9}, {
   3.817843485966963*^9, 3.8178434962203817`*^9}, {3.817843661190214*^9, 
   3.817843771528948*^9}, {3.817844014027123*^9, 3.81784401462327*^9}, {
   3.8178440864821978`*^9, 3.8178440902309303`*^9}, {3.817844121743362*^9, 
   3.817844151417705*^9}, {3.819486472846402*^9, 3.81948649392764*^9}, 
   3.819486597293994*^9, {3.819489629006962*^9, 3.819489630098672*^9}, {
   3.819490045245195*^9, 3.8194900482756777`*^9}, {3.8194908134237213`*^9, 
   3.819490815949222*^9}, {3.819491128284195*^9, 3.819491129063471*^9}, {
   3.819493194224258*^9, 3.819493204962335*^9}, {3.8194934481537247`*^9, 
   3.819493495292267*^9}, 3.819493801098443*^9, {3.81949388235677*^9, 
   3.8194938906888227`*^9}, {3.819493946704257*^9, 3.819493950199361*^9}, {
   3.819494931428831*^9, 3.819494950730949*^9}, 3.81949983626408*^9, {
   3.81949987529279*^9, 3.8194998814127207`*^9}, {3.819500898378232*^9, 
   3.819500898509733*^9}, {3.819501473477264*^9, 3.8195014757276373`*^9}, {
   3.819503212184637*^9, 3.819503212316696*^9}, {3.8195140742873087`*^9, 
   3.8195140868240147`*^9}, {3.8197322948590527`*^9, 3.819732301100499*^9}, {
   3.819737474657263*^9, 3.819737577512883*^9}, {3.819737637010407*^9, 
   3.819737639318727*^9}, {3.819737734943492*^9, 3.8197377933098803`*^9}, 
   3.819737864027547*^9, {3.819737954144932*^9, 3.819738125020088*^9}, {
   3.819738160718255*^9, 3.819738180546109*^9}, {3.819745816535221*^9, 
   3.8197458244641047`*^9}, {3.819745906306087*^9, 3.819746032981805*^9}, {
   3.819746081388941*^9, 3.8197461034261703`*^9}, {3.8197461343065033`*^9, 
   3.81974614535293*^9}, {3.8197462981782637`*^9, 3.819746320226494*^9}, {
   3.819746403828623*^9, 3.81974644801488*^9}, {3.819746522464098*^9, 
   3.819746783096182*^9}, {3.8197468558173933`*^9, 3.8197468561133432`*^9}, {
   3.819746897712071*^9, 3.819746910702548*^9}, {3.8197488710641327`*^9, 
   3.8197488712114983`*^9}, {3.819748999272318*^9, 3.81974900107082*^9}, {
   3.8197491462352457`*^9, 3.819749204090967*^9}, {3.81974964333254*^9, 
   3.8197496699823217`*^9}, 3.819824608933195*^9, {3.819824694051777*^9, 
   3.819824697484661*^9}, {3.819824919178471*^9, 3.819824919818994*^9}, {
   3.8198250570883837`*^9, 3.819825058886527*^9}, {3.820086091943551*^9, 
   3.8200861751768627`*^9}, {3.820086445981159*^9, 3.820086465103344*^9}, {
   3.820086661354301*^9, 3.820086662765345*^9}, 3.8200867010893087`*^9, 
   3.820133727744009*^9, {3.8201338340155373`*^9, 3.820133838357328*^9}, {
   3.820133907151497*^9, 3.820133910115299*^9}, {3.820134469361924*^9, 
   3.820134518151558*^9}, 3.820134675057188*^9, {3.820134712831873*^9, 
   3.820134799515667*^9}, {3.820134969907497*^9, 3.820134976169382*^9}, {
   3.820135085961451*^9, 3.820135103181726*^9}, 3.8201353408036747`*^9, {
   3.8201354591692057`*^9, 3.820135461505659*^9}, {3.820135494026733*^9, 
   3.820135540834093*^9}, {3.820135593687048*^9, 3.820135599446433*^9}, {
   3.820135634593583*^9, 3.82013566944578*^9}, {3.820136715131727*^9, 
   3.8201367176563168`*^9}, {3.820136861299157*^9, 3.820136929067068*^9}, {
   3.8201369719142427`*^9, 3.820136998416891*^9}, {3.8201370768083477`*^9, 
   3.820137077015003*^9}, {3.820137146261764*^9, 3.820137153294528*^9}, {
   3.832945138933613*^9, 3.832945143474053*^9}, {3.833164765211884*^9, 
   3.833164775682088*^9}, {3.8331661074041224`*^9, 3.833166107969401*^9}},
 FontSize->18,
 CellLabel->"In[83]:=",ExpressionUUID->"02b3b250-42a3-46b2-817f-451d43c4cbe3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Datarules for isw = 3 (Do not modify)", "Subsection",
 CellChangeTimes->{{3.817788677141033*^9, 3.817788686558289*^9}, {
  3.817844296386916*^9, 
  3.817844298615546*^9}},ExpressionUUID->"23e21df3-22fe-4e15-bd54-\
e773e5ac390c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Rules", " ", "for", " ", "tangent"}], " ", "&"}], " ", 
     "residual", " ", "environment", " ", "isw"}], " ", "=", " ", "3"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"SMSStandardModule", "[", "\"\<Tangent and residual\>\"", "]"}], 
     ":=", "\n", 
     RowBox[{"SMSModule", "[", 
      RowBox[{
       RowBox[{"elemname", "<>", "\"\<_ISW03\>\""}], ",", 
       RowBox[{"Real", "[", 
        RowBox[{
         RowBox[{"d$$", "[", "nmatdata", "]"}], ",", 
         RowBox[{"xl$$", "[", 
          RowBox[{"ndm", ",", 
           RowBox[{
           "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"ul$$", "[", 
          RowBox[{"6", ",", "nst"}], "]"}], ",", "\n", 
         RowBox[{"s$$", "[", 
          RowBox[{"nst", ",", "nst"}], "]"}], ",", 
         RowBox[{"c$$", "[", 
          RowBox[{"nst", ",", "nst"}], "]"}], ",", 
         RowBox[{"m$$", "[", 
          RowBox[{"nst", ",", "nst"}], "]"}], ",", 
         RowBox[{"p$$", "[", "nst", "]"}], ",", "\n", 
         RowBox[{"ht$$", "[", "hist1", "]"}], ",", 
         RowBox[{"hp$$", "[", "hist3", "]"}], ",", 
         RowBox[{"gp$$", "[", 
          RowBox[{"4", ",", "ngp"}], "]"}]}], "]"}], ",", 
       RowBox[{"Integer", "[", "ngpo$$", "]"}]}], "]"}]}], ";"}], 
   "Code"]}]], "Code",
 CellChangeTimes->{{3.8156940293357573`*^9, 3.815694029817733*^9}, {
   3.815694090191*^9, 3.815694115136477*^9}, {3.815694373965843*^9, 
   3.815694376157591*^9}, 3.815695040182564*^9, {3.815695089291833*^9, 
   3.8156950902778063`*^9}, {3.815696580487351*^9, 3.815696582116392*^9}, 
   3.8156979477526007`*^9, {3.8157033823533382`*^9, 3.815703390377243*^9}, {
   3.8158010900564327`*^9, 3.815801099641144*^9}, {3.815801343808868*^9, 
   3.8158013884643087`*^9}, {3.816037767587674*^9, 3.816037767631958*^9}, {
   3.816216024784294*^9, 3.816216028471406*^9}, 3.8162160831390123`*^9, {
   3.8177618928550367`*^9, 3.81776190133885*^9}, {3.8177619499179697`*^9, 
   3.8177619617265987`*^9}, {3.817764011895918*^9, 3.817764027600162*^9}, {
   3.817764093257338*^9, 3.817764093779439*^9}, {3.817764204964443*^9, 
   3.817764205068942*^9}, {3.8177643065168247`*^9, 3.81776431191643*^9}, {
   3.8177643592566547`*^9, 3.817764430446224*^9}, {3.817764515677899*^9, 
   3.817764516291233*^9}, {3.817788326463664*^9, 3.817788337063575*^9}, {
   3.817788367622243*^9, 3.817788370653777*^9}, {3.817788689305355*^9, 
   3.817788692857608*^9}, {3.8178117625617*^9, 3.8178117703774443`*^9}, 
   3.817812661635215*^9, {3.817812808208273*^9, 3.817812820613452*^9}, {
   3.8178128862589903`*^9, 3.8178129227198467`*^9}, 3.817817774664094*^9, {
   3.817818079945755*^9, 3.817818089948107*^9}, 3.817818125680705*^9, {
   3.8178244036482687`*^9, 3.81782440418128*^9}, {3.817843937055566*^9, 
   3.817843943333085*^9}, {3.818338550154429*^9, 3.8183385631489267`*^9}, {
   3.819749694122587*^9, 3.819749695526428*^9}, {3.833164795155118*^9, 
   3.8331647962925587`*^9}},
 FontSize->18,
 CellLabel->"In[89]:=",ExpressionUUID->"367df672-3f63-49e3-aef9-5d3823663d1e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residual and Tangent calculation (isw = 3) (Do not modify)", "Section",
 CellChangeTimes->{{3.813843079328302*^9, 3.8138430855250587`*^9}, {
  3.817817713235415*^9, 3.817817716768817*^9}, {3.818339419369236*^9, 
  3.818339423029744*^9}},
 FontSize->18,ExpressionUUID->"4f9cc765-f95b-49c3-bd58-46b4ef10bb89"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{"SMSStandardModule", "[", "\"\<Tangent and residual\>\"", "]"}], 
    ";"}],
   FontSize->16], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "Start", " ", "loop", " ", "over", " ", "all", " ", "integration", " ", 
     "points"}], " ", "*)"}],
   FontSize->16]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSDo", "[", 
    RowBox[{"Ig", ",", "1", ",", 
     RowBox[{"SMSInteger", "[", 
      RowBox[{"es$$", "[", 
       RowBox[{"\"\<id\>\"", ",", "\"\<NoIntPoints\>\""}], "]"}], "]"}]}], 
    "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"ElementDefinitions", "[", "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Rg", "\[DoubleRightTee]", " ", 
    RowBox[{"JXd", "*", "wgp", "*", "Weakform"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSExport", "[", 
    RowBox[{
     RowBox[{"SMSResidualSign", " ", "Rg"}], ",", "p$$", ",", 
     RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Kg", "\[DoubleRightTee]", 
    RowBox[{"SMSD", "[", 
     RowBox[{"Rg", ",", "ppf"}], "]"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Cg", "\[DoubleRightTee]", 
    RowBox[{"SMSD", "[", 
     RowBox[{"Rg", ",", "ppvf"}], "]"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Mg", "\[DoubleRightTee]", 
    RowBox[{"SMSD", "[", 
     RowBox[{"Rg", ",", "ppaf"}], "]"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSExport", "[", 
    RowBox[{"Kg", ",", "s$$", ",", 
     RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSExport", "[", 
    RowBox[{"Cg", ",", "c$$", ",", 
     RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSExport", "[", 
    RowBox[{"Mg", ",", "m$$", ",", 
     RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSEndDo", "[", "]"}], ";"}],
  FontSize->16]}], "Code",
 CellChangeTimes->{
  3.818339435232471*^9, {3.818339685061678*^9, 3.8183396938146343`*^9}, {
   3.81833985752962*^9, 3.818339864746772*^9}, {3.818780467769853*^9, 
   3.81878047032121*^9}, {3.818781080795745*^9, 3.81878110094565*^9}, {
   3.818783089035557*^9, 3.818783090947382*^9}, 3.819071415350791*^9},
 FontSize->18,
 CellLabel->"In[90]:=",ExpressionUUID->"71cb5dc6-98c0-41b5-80fb-c40143ac64bc"],

Cell[CellGroupData[{

Cell["Datarules for isw = 5 (Do not modify)", "Subsection",
 CellChangeTimes->{{3.817788677141033*^9, 3.817788686558289*^9}, {
   3.817844296386916*^9, 3.817844298615546*^9}, 
   3.819059941343779*^9},ExpressionUUID->"d6513e9a-695d-4b6e-afdf-\
6dbdc10049dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Rules", " ", "for", " ", "Mass", " ", "matrix", " ", "isw"}], 
    " ", "=", " ", "5"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"SMSModule", "[", 
      RowBox[{
       RowBox[{"elemname", "<>", "\"\<_ISW05\>\""}], ",", 
       RowBox[{"Real", "[", 
        RowBox[{
         RowBox[{"d$$", "[", "nmatdata", "]"}], ",", 
         RowBox[{"xl$$", "[", 
          RowBox[{"ndm", ",", 
           RowBox[{
           "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"ul$$", "[", 
          RowBox[{"6", ",", "nst"}], "]"}], ",", 
         RowBox[{"m$$", "[", 
          RowBox[{"nst", ",", "nst"}], "]"}], ",", 
         RowBox[{"p$$", "[", "nst", "]"}], ",", "\n", 
         RowBox[{"ht$$", "[", "hist1", "]"}], ",", 
         RowBox[{"hp$$", "[", "hist3", "]"}], ",", 
         RowBox[{"gp$$", "[", 
          RowBox[{"4", ",", "ngp"}], "]"}]}], "]"}], ",", 
       RowBox[{"Integer", "[", "ngpo$$", "]"}]}], "]"}], ";"}], "Code"], 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{
     RowBox[{"SMSDo", "[", 
      RowBox[{"Ig", ",", "1", ",", 
       RowBox[{"SMSInteger", "[", 
        RowBox[{"es$$", "[", 
         RowBox[{"\"\<id\>\"", ",", "\"\<NoIntPoints\>\""}], "]"}], "]"}]}], 
      "]"}], ";"}],
    FontSize->16], 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{
     RowBox[{"ElementDefinitions", "[", "]"}], ";"}],
    FontSize->16], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"Rg", "\[DoubleRightTee]", " ", 
      RowBox[{"JXd", "*", "wgp", "*", "Weakform"}]}], ";"}],
    FontSize->16], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"Mg", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"Rg", ",", "ppaf"}], "]"}]}], ";"}],
    FontSize->16], 
   StyleBox["\n",
    FontSize->16], 
   StyleBox[
    RowBox[{
     RowBox[{"SMSExport", "[", 
      RowBox[{"Mg", ",", "m$$", ",", 
       RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
    FontSize->16], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"SMSEndDo", "[", "]"}], ";"}],
    FontSize->16]}]}]], "Code",
 CellChangeTimes->{{3.8156940293357573`*^9, 3.815694029817733*^9}, {
   3.815694090191*^9, 3.815694115136477*^9}, {3.815694373965843*^9, 
   3.815694376157591*^9}, 3.815695040182564*^9, {3.815695089291833*^9, 
   3.8156950902778063`*^9}, {3.815696580487351*^9, 3.815696582116392*^9}, 
   3.8156979477526007`*^9, {3.8157033823533382`*^9, 3.815703390377243*^9}, {
   3.8158010900564327`*^9, 3.815801099641144*^9}, {3.815801343808868*^9, 
   3.8158013884643087`*^9}, {3.816037767587674*^9, 3.816037767631958*^9}, {
   3.816216024784294*^9, 3.816216028471406*^9}, 3.8162160831390123`*^9, {
   3.8177618928550367`*^9, 3.81776190133885*^9}, {3.8177619499179697`*^9, 
   3.8177619617265987`*^9}, {3.817764011895918*^9, 3.817764027600162*^9}, {
   3.817764093257338*^9, 3.817764093779439*^9}, {3.817764204964443*^9, 
   3.817764205068942*^9}, {3.8177643065168247`*^9, 3.81776431191643*^9}, {
   3.8177643592566547`*^9, 3.817764430446224*^9}, {3.817764515677899*^9, 
   3.817764516291233*^9}, {3.817788326463664*^9, 3.817788337063575*^9}, {
   3.817788367622243*^9, 3.817788370653777*^9}, {3.817788689305355*^9, 
   3.817788692857608*^9}, {3.8178117625617*^9, 3.8178117703774443`*^9}, 
   3.817812661635215*^9, {3.817812808208273*^9, 3.817812820613452*^9}, {
   3.8178128862589903`*^9, 3.8178129227198467`*^9}, 3.817817774664094*^9, {
   3.817818079945755*^9, 3.817818089948107*^9}, 3.817818125680705*^9, {
   3.8178244036482687`*^9, 3.81782440418128*^9}, {3.817843937055566*^9, 
   3.817843943333085*^9}, {3.818338550154429*^9, 3.8183385631489267`*^9}, {
   3.819059953806457*^9, 3.819059968775601*^9}, {3.819062010886059*^9, 
   3.819062041223555*^9}, {3.8191610157548122`*^9, 3.819161019207489*^9}, {
   3.8192346909624043`*^9, 3.8192346918737926`*^9}, {3.819749737036462*^9, 
   3.819749737407956*^9}, {3.833164804756373*^9, 3.833164805642282*^9}},
 FontSize->18,
 CellLabel->
  "In[102]:=",ExpressionUUID->"1ccef569-83c5-46d8-9e14-73e6e8c24684"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residual calculation (isw = 6) (Do not modify)", "Section",
 CellChangeTimes->{{3.813843079328302*^9, 3.8138430855250587`*^9}, {
  3.817817713235415*^9, 3.817817716768817*^9}, {3.818339419369236*^9, 
  3.818339423029744*^9}, {3.819062244704084*^9, 3.819062247222887*^9}},
 FontSize->18,ExpressionUUID->"7c2c5b1c-6d5d-478d-aa2a-f3aba3ce102b"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   RowBox[{
    RowBox[{
     StyleBox["SMSModule", "Code"], 
     StyleBox["[", "Code"], 
     RowBox[{
      RowBox[{"elemname", "<>", "\"\<_ISW06\>\""}], 
      StyleBox[",", "Code"], 
      RowBox[{
       StyleBox["Real", "Code"], 
       StyleBox["[", "Code"], 
       RowBox[{
        StyleBox[
         RowBox[{"d$$", "[", "nmatdata", "]"}], "Code"], 
        StyleBox[",", "Code"], 
        RowBox[{
         StyleBox["xl$$", "Code"], 
         StyleBox["[", "Code"], 
         RowBox[{
          StyleBox["ndm", "Code"], 
          StyleBox[",", "Code"], 
          RowBox[{"nelu", 
           StyleBox["\[LeftDoubleBracket]", "Code"], 
           StyleBox["1", "Code"], 
           StyleBox["\[RightDoubleBracket]", "Code"]}]}], 
         StyleBox["]", "Code"]}], 
        StyleBox[",", "Code"], 
        StyleBox[
         RowBox[{"ul$$", "[", 
          RowBox[{"6", ",", "nst"}], "]"}], "Code"], 
        StyleBox[",", "Code"], 
        StyleBox[
         RowBox[{"p$$", "[", "nst", "]"}], "Code"], 
        StyleBox[",", "Code"], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"ht$$", "[", "hist1", "]"}], "Code"], 
        StyleBox[",", "Code"], 
        StyleBox[
         RowBox[{"hp$$", "[", "hist3", "]"}], "Code"], 
        StyleBox[",", "Code"], 
        StyleBox[
         RowBox[{"gp$$", "[", 
          RowBox[{"4", ",", "ngp"}], "]"}], "Code"]}], 
       StyleBox["]", "Code"]}], 
      StyleBox[",", "Code"], 
      StyleBox[
       RowBox[{"Integer", "[", "ngpo$$", "]"}], "Code"]}], 
     StyleBox["]", "Code"]}], 
    StyleBox[";", "Code"]}],
   FontSize->16], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"(*", " ", 
    RowBox[{
    "Start", " ", "loop", " ", "over", " ", "all", " ", "integration", " ", 
     "points"}], " ", "*)"}],
   FontSize->16]}], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSDo", "[", 
    RowBox[{"Ig", ",", "1", ",", 
     RowBox[{"SMSInteger", "[", 
      RowBox[{"es$$", "[", 
       RowBox[{"\"\<id\>\"", ",", "\"\<NoIntPoints\>\""}], "]"}], "]"}]}], 
    "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"ElementDefinitions", "[", "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"Rg", "\[DoubleRightTee]", " ", 
    RowBox[{"JXd", "*", "wgp", "*", "Weakform"}]}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSExport", "[", 
    RowBox[{
     RowBox[{"SMSResidualSign", " ", "Rg"}], ",", "p$$", ",", 
     RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
  FontSize->16], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   RowBox[{"SMSEndDo", "[", "]"}], ";"}],
  FontSize->16]}], "Code",
 CellChangeTimes->{
  3.818339435232471*^9, {3.818339685061678*^9, 3.8183396938146343`*^9}, {
   3.81833985752962*^9, 3.818339864746772*^9}, {3.818780467769853*^9, 
   3.81878047032121*^9}, {3.818781080795745*^9, 3.81878110094565*^9}, {
   3.818783089035557*^9, 3.818783090947382*^9}, {3.81906225824723*^9, 
   3.8190622816088123`*^9}, 3.8190714104286346`*^9, {3.819161001350765*^9, 
   3.819161003862027*^9}, {3.8192343091362743`*^9, 3.8192343105553007`*^9}, {
   3.819749741951612*^9, 3.819749742400943*^9}, {3.833164808759385*^9, 
   3.8331648097476463`*^9}},
 FontSize->18,
 CellLabel->
  "In[109]:=",ExpressionUUID->"1789c464-e393-4306-860a-baf601ffc1eb"],

Cell[CellGroupData[{

Cell["Datarules for isw = 9 (Do not modify)", "Subsection",
 CellChangeTimes->{{3.817788677141033*^9, 3.817788686558289*^9}, {
   3.817844296386916*^9, 3.817844298615546*^9}, 3.819059941343779*^9, 
   3.8192353317670097`*^9},ExpressionUUID->"6d4443b3-a83b-4332-8a30-\
974d8de572c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Rules", " ", "for", " ", "Mass", " ", "matrix", " ", "isw"}], 
    " ", "=", " ", "5"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"SMSModule", "[", 
      RowBox[{
       RowBox[{"elemname", "<>", "\"\<_ISW09\>\""}], ",", 
       RowBox[{"Real", "[", 
        RowBox[{
         RowBox[{"d$$", "[", "nmatdata", "]"}], ",", 
         RowBox[{"xl$$", "[", 
          RowBox[{"ndm", ",", 
           RowBox[{
           "nelu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"ul$$", "[", 
          RowBox[{"6", ",", "nst"}], "]"}], ",", 
         RowBox[{"c$$", "[", 
          RowBox[{"nst", ",", "nst"}], "]"}], ",", 
         RowBox[{"p$$", "[", "nst", "]"}], ",", "\n", 
         RowBox[{"ht$$", "[", "hist1", "]"}], ",", 
         RowBox[{"hp$$", "[", "hist3", "]"}], ",", 
         RowBox[{"gp$$", "[", 
          RowBox[{"4", ",", "ngp"}], "]"}]}], "]"}], ",", 
       RowBox[{"Integer", "[", "ngpo$$", "]"}]}], "]"}], ";"}], "Code"], 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{
     RowBox[{"SMSDo", "[", 
      RowBox[{"Ig", ",", "1", ",", 
       RowBox[{"SMSInteger", "[", 
        RowBox[{"es$$", "[", 
         RowBox[{"\"\<id\>\"", ",", "\"\<NoIntPoints\>\""}], "]"}], "]"}]}], 
      "]"}], ";"}],
    FontSize->16], 
   StyleBox["\n", "Code"], 
   StyleBox[
    RowBox[{
     RowBox[{"ElementDefinitions", "[", "]"}], ";"}],
    FontSize->16], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"Rg", "\[DoubleRightTee]", " ", 
      RowBox[{"JXd", "*", "wgp", "*", "Weakform"}]}], ";"}],
    FontSize->16], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"Cg", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"Rg", ",", "ppvf"}], "]"}]}], ";"}],
    FontSize->16], 
   StyleBox["\n",
    FontSize->16], 
   StyleBox[
    RowBox[{
     RowBox[{"SMSExport", "[", 
      RowBox[{"Cg", ",", "c$$", ",", 
       RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], ";"}],
    FontSize->16], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"SMSEndDo", "[", "]"}], ";"}],
    FontSize->16]}]}]], "Code",
 CellChangeTimes->{{3.8156940293357573`*^9, 3.815694029817733*^9}, {
   3.815694090191*^9, 3.815694115136477*^9}, {3.815694373965843*^9, 
   3.815694376157591*^9}, 3.815695040182564*^9, {3.815695089291833*^9, 
   3.8156950902778063`*^9}, {3.815696580487351*^9, 3.815696582116392*^9}, 
   3.8156979477526007`*^9, {3.8157033823533382`*^9, 3.815703390377243*^9}, {
   3.8158010900564327`*^9, 3.815801099641144*^9}, {3.815801343808868*^9, 
   3.8158013884643087`*^9}, {3.816037767587674*^9, 3.816037767631958*^9}, {
   3.816216024784294*^9, 3.816216028471406*^9}, 3.8162160831390123`*^9, {
   3.8177618928550367`*^9, 3.81776190133885*^9}, {3.8177619499179697`*^9, 
   3.8177619617265987`*^9}, {3.817764011895918*^9, 3.817764027600162*^9}, {
   3.817764093257338*^9, 3.817764093779439*^9}, {3.817764204964443*^9, 
   3.817764205068942*^9}, {3.8177643065168247`*^9, 3.81776431191643*^9}, {
   3.8177643592566547`*^9, 3.817764430446224*^9}, {3.817764515677899*^9, 
   3.817764516291233*^9}, {3.817788326463664*^9, 3.817788337063575*^9}, {
   3.817788367622243*^9, 3.817788370653777*^9}, {3.817788689305355*^9, 
   3.817788692857608*^9}, {3.8178117625617*^9, 3.8178117703774443`*^9}, 
   3.817812661635215*^9, {3.817812808208273*^9, 3.817812820613452*^9}, {
   3.8178128862589903`*^9, 3.8178129227198467`*^9}, 3.817817774664094*^9, {
   3.817818079945755*^9, 3.817818089948107*^9}, 3.817818125680705*^9, {
   3.8178244036482687`*^9, 3.81782440418128*^9}, {3.817843937055566*^9, 
   3.817843943333085*^9}, {3.818338550154429*^9, 3.8183385631489267`*^9}, {
   3.819059953806457*^9, 3.819059968775601*^9}, {3.819062010886059*^9, 
   3.819062041223555*^9}, {3.8191610157548122`*^9, 3.819161019207489*^9}, {
   3.8192346909624043`*^9, 3.8192346918737926`*^9}, {3.8192353341223917`*^9, 
   3.81923535836056*^9}, {3.819749746739564*^9, 3.819749747184009*^9}, {
   3.8331648153933372`*^9, 3.833164823456357*^9}},
 FontSize->18,
 CellLabel->
  "In[115]:=",ExpressionUUID->"d4e60ef1-ce56-44fa-add2-d199a626e689"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate the user element (Do not modify)", "Subsection",
 CellChangeTimes->{{3.8183392799035892`*^9, 
  3.818339286566512*^9}},ExpressionUUID->"41b23f47-3344-4306-8202-\
8c411b140449"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SMSWrite", "[", 
   RowBox[{"elemname", ",", 
    RowBox[{"\"\<Splice\>\"", "\[Rule]", "\"\<SMTFEAP.mf\>\""}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.814029683902101*^9, {3.814065148525612*^9, 3.814065149994444*^9}, {
   3.814065267344488*^9, 3.8140652701471567`*^9}, {3.8140653395234203`*^9, 
   3.814065340212381*^9}, {3.8141288210135593`*^9, 3.814128823453817*^9}, {
   3.814128974400188*^9, 3.814128975269434*^9}, {3.814129989400097*^9, 
   3.814129991936172*^9}, {3.814132894117566*^9, 3.814132900366117*^9}, {
   3.8141336076569*^9, 3.814133610852857*^9}, {3.814134098007976*^9, 
   3.8141340987482243`*^9}, 3.8145696600099783`*^9, {3.814761713784013*^9, 
   3.8147617146247597`*^9}, 3.8156941415540133`*^9, {3.815695027565517*^9, 
   3.815695029785602*^9}, {3.8156981160277443`*^9, 3.8156981200821657`*^9}, {
   3.815703514772353*^9, 3.8157035184401712`*^9}, {3.8157954062986*^9, 
   3.815795406898543*^9}, {3.81579869526889*^9, 3.8157986954027967`*^9}, 
   3.815804836241522*^9, 3.815805121629422*^9, 3.8158632016130123`*^9, {
   3.815978002335328*^9, 3.815978004192481*^9}, {3.815978074473092*^9, 
   3.815978084875784*^9}, {3.8160302262406*^9, 3.816030229893783*^9}, 
   3.816030329719241*^9, 3.8160359284494333`*^9, {3.816037090049592*^9, 
   3.816037090374529*^9}, 3.816215155199511*^9, 3.816216187849173*^9, 
   3.816271175830041*^9, {3.816278248692532*^9, 3.816278248821385*^9}, {
   3.8162842131060247`*^9, 3.816284219833948*^9}, {3.8162844711368856`*^9, 
   3.816284473674637*^9}, 3.816284603562101*^9, {3.8177640394812803`*^9, 
   3.81776406419633*^9}, {3.817788394791363*^9, 3.817788399538883*^9}, {
   3.8178438346617603`*^9, 3.8178438350628653`*^9}, {3.818780481480461*^9, 
   3.818780484103034*^9}, 3.819054459680669*^9, 3.819486499870843*^9, 
   3.8194908258275003`*^9, 3.819746434067689*^9, {3.819750028954262*^9, 
   3.8197500305125732`*^9}, {3.833161639673225*^9, 3.833161639780781*^9}},
 FontSize->18,
 CellLabel->
  "In[122]:=",ExpressionUUID->"354eb85d-bdb8-456e-8f0b-73628af2e8df"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       StyleBox["\"File: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "\"elmt16.f\"", 
       StyleBox["\"  Size: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "28002", 
       StyleBox["\"  Time: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "9"},
      "RowDefault"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["\<\"Method\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"elmt16_ISW01\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"elmt16_ISW03\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"elmt16_ISW05\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"elmt16_ISW06\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"elmt16_ISW09\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox["\<\"No.Formulae\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "5", "141", "41", "77", "1"},
        {
         StyleBox["\<\"No.Leafs\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "57", "3530", "893", "1065", "450"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Center}}},
       GridBoxDividers->{"Columns" -> {True, True}},
       GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Rows" -> {True, True}},
   GridBoxFrame->{"Columns" -> False, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{3.833247849558014*^9},
 CellLabel->
  "During evaluation of \
In[122]:=",ExpressionUUID->"3c082855-8aa2-47a4-a594-45d2990d2e2b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1024, 1313},
WindowMargins->{{Automatic, -309}, {507, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->FrontEnd`FileName[{"AceStyles"}, "AceStyle.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"4fa3d543-def5-4f52-8962-bd4d64c93f8c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 484, 6, 63, "Title",ExpressionUUID->"64563710-8a1c-4ca3-aa84-b2f18d0cd79e"],
Cell[CellGroupData[{
Cell[1089, 32, 199, 2, 45, "Subtitle",ExpressionUUID->"7cfc5b2b-cb62-48bf-90c7-5d568d7ac901"],
Cell[1291, 36, 1034, 21, 129, "Subsubtitle",ExpressionUUID->"35589579-62fe-4820-97ef-3b1b3a6c0d28"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2374, 63, 218, 3, 63, "Title",ExpressionUUID->"ae2105f6-22e3-4fc6-a8c7-18940e5d6e3f"],
Cell[2595, 68, 163, 4, 35, "Input",ExpressionUUID->"28ab4327-825f-42ea-8570-27c52a71732c"],
Cell[CellGroupData[{
Cell[2783, 76, 268, 4, 37, "Subsection",ExpressionUUID->"e7079cb9-11b7-4fe8-9fea-d30e2d112d03"],
Cell[3054, 82, 4730, 109, 402, "Code",ExpressionUUID->"5b6d2078-2e34-4938-bd9c-1e1d63644703"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7821, 196, 233, 4, 37, "Subsection",ExpressionUUID->"fe9279c1-0aaf-4af4-81ee-1654b90fb8f3"],
Cell[8057, 202, 467, 12, 51, "Code",ExpressionUUID->"93578910-7505-4ecc-a55a-0f3f8ffe409d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8561, 219, 261, 3, 58, "Section",ExpressionUUID->"6d3af47e-d1b5-4998-a355-fee1f44f1df7"],
Cell[8825, 224, 3193, 72, 400, "Code",ExpressionUUID->"74aecf2e-b33b-468c-84f2-00e88b04518f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12055, 301, 236, 3, 58, "Section",ExpressionUUID->"8ab5073c-1a9a-42f8-8a12-b859b69c83b8"],
Cell[12294, 306, 2628, 46, 284, "Code",ExpressionUUID->"c192d2a7-c89d-4ee8-9a9a-f50f7a60f08e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14959, 357, 265, 3, 58, "Section",ExpressionUUID->"ce1b9402-a5f4-4d56-a343-7b0d4df54d0b"],
Cell[15227, 362, 7124, 173, 632, "Code",ExpressionUUID->"ce4777e9-97e5-4f34-8348-4ca5fa01b98d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22388, 540, 385, 6, 58, "Section",ExpressionUUID->"094f8ccb-e91a-4ef8-845f-4f46d45fef89"],
Cell[22776, 548, 5576, 119, 569, "Code",ExpressionUUID->"6d8458d0-9e5a-4140-a3ed-82c4c3116bf7"],
Cell[CellGroupData[{
Cell[28377, 671, 232, 4, 37, "Subsection",ExpressionUUID->"ab069be5-e32a-4d21-ba40-b402d2ba8a9b"],
Cell[28612, 677, 23087, 667, 1073, "Code",ExpressionUUID->"dde91a87-c570-4878-ab7e-5f79f3886c6d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51748, 1350, 305, 4, 58, "Section",ExpressionUUID->"1c38b0e5-ec87-488e-8aa9-5e8a4a423d41"],
Cell[52056, 1356, 5849, 178, 577, "Code",ExpressionUUID->"4fb3fc8d-4150-49ed-9830-4e1f59efd1c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57942, 1539, 337, 6, 58, "Section",ExpressionUUID->"0074e2a8-42bf-4549-b46e-910e7e90962c"],
Cell[58282, 1547, 1144, 28, 153, "Code",ExpressionUUID->"deffe977-de30-4b8b-b057-1dfc8591b4f6"],
Cell[CellGroupData[{
Cell[59451, 1579, 250, 4, 37, "Subsection",ExpressionUUID->"5cc5b2e5-9747-4eae-b459-9eb8f22e836a"],
Cell[59704, 1585, 1130, 24, 205, "Code",ExpressionUUID->"b077288f-0e29-4c2f-a905-c8509a35b19a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60871, 1614, 238, 4, 37, "Subsection",ExpressionUUID->"8b854d03-5ba4-4f60-9af8-010ee0e7c1e8"],
Cell[61112, 1620, 4613, 76, 197, "Code",ExpressionUUID->"02b3b250-42a3-46b2-817f-451d43c4cbe3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65762, 1701, 234, 4, 37, "Subsection",ExpressionUUID->"23e21df3-22fe-4e15-bd54-e773e5ac390c"],
Cell[65999, 1707, 3206, 64, 168, "Code",ExpressionUUID->"367df672-3f63-49e3-aef9-5d3823663d1e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69254, 1777, 313, 4, 58, "Section",ExpressionUUID->"4f9cc765-f95b-49c3-bd58-46b4ef10bb89"],
Cell[69570, 1783, 2787, 84, 400, "Code",ExpressionUUID->"71cb5dc6-98c0-41b5-80fb-c40143ac64bc"],
Cell[CellGroupData[{
Cell[72382, 1871, 258, 4, 37, "Subsection",ExpressionUUID->"d6513e9a-695d-4b6e-afdf-6dbdc10049dd"],
Cell[72643, 1877, 4193, 95, 284, "Code",ExpressionUUID->"1ccef569-83c5-46d8-9e14-73e6e8c24684"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76885, 1978, 347, 4, 58, "Section",ExpressionUUID->"7c2c5b1c-6d5d-478d-aa2a-f3aba3ce102b"],
Cell[77235, 1984, 3419, 99, 255, "Code",ExpressionUUID->"1789c464-e393-4306-860a-baf601ffc1eb"],
Cell[CellGroupData[{
Cell[80679, 2087, 282, 4, 37, "Subsection",ExpressionUUID->"6d4443b3-a83b-4332-8a30-974d8de572c9"],
Cell[80964, 2093, 4246, 96, 284, "Code",ExpressionUUID->"d4e60ef1-ce56-44fa-add2-d199a626e689"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85247, 2194, 191, 3, 37, "Subsection",ExpressionUUID->"41b23f47-3344-4306-8202-8c411b140449"],
Cell[CellGroupData[{
Cell[85463, 2201, 2059, 33, 35, "Input",ExpressionUUID->"354eb85d-bdb8-456e-8f0b-73628af2e8df"],
Cell[87525, 2236, 3639, 92, 86, "Print",ExpressionUUID->"3c082855-8aa2-47a4-a594-45d2990d2e2b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

