(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     56806,       1347]
NotebookOptionsPosition[     54361,       1295]
NotebookOutlinePosition[     54922,       1314]
CellTagsIndexPosition[     54879,       1311]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Poroelastic element", "Title",
 CellChangeTimes->{{3.813842184750062*^9, 3.813842202328751*^9}},
 FontSize->18,ExpressionUUID->"ae2105f6-22e3-4fc6-a8c7-18940e5d6e3f"],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.8138422207483377`*^9, 3.813842227213697*^9}},
 FontSize->18,ExpressionUUID->"8ab5073c-1a9a-42f8-8a12-b859b69c83b8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "AceGen`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSInitialize", "[", 
   RowBox[{"\"\<PoroTH_v1\>\"", ",", 
    RowBox[{"\"\<Environment\>\"", "->", "\"\<FEAP\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSTemplate", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Element", " ", "Topology"}], " ", "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"\"\<SMSTopology\>\"", "\[Rule]", " ", "\"\<Q2\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSNoNodes\>\"", "\[Rule]", "9"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSSymmetricTangent\>\"", "\[Rule]", "False"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSDOFGlobal\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "3", ",", "3", ",", "3", ",", "2", ",", "2", ",", "2", ",", 
       "2", ",", "2"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSNodeID\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<D\>\"", ",", "\"\<D\>\"", ",", "\"\<D\>\"", ",", "\"\<D\>\"", ",", 
       "\"\<D\>\"", ",", "\"\<D\>\"", ",", "\"\<D\>\"", ",", "\"\<D\>\"", 
       ",", "\"\<D\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<SMSDomainDataNames\>\"", "\[Rule]", " ", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Kd - Drained bulk modulus\>\"", ",", 
       "\"\<\[Mu] - Shear modulus\>\"", ",", 
       "\"\<\[Gamma] -1/Biot Modulus\>\"", ",", "\"\<kp -permeability\>\"", 
       ",", "\"\<\[Alpha] -poro parameter\>\"", ",", 
       "\"\<\[Rho]0 -density\>\""}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<SMSDefaultData\>\"", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0.25", ",", "2700", ",", "0.5", ",", "0.5", ",", "2700"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.813842248964122*^9, 3.81384227748343*^9}, 
   3.8138432700597343`*^9, {3.814028909598077*^9, 3.814028916615013*^9}, {
   3.814132879109413*^9, 3.814132880164461*^9}, {3.814133627592999*^9, 
   3.814133627955427*^9}, {3.814569078254141*^9, 3.8145691351173058`*^9}, {
   3.814761756733983*^9, 3.814761759374629*^9}, {3.815240048166686*^9, 
   3.8152400482847357`*^9}},
 FontSize->18,
 CellLabel->"In[1]:=",ExpressionUUID->"d48f5ec4-4493-44eb-85e7-d95bc4a4b323"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Element definition: Kinematical quantities", "Section",
 CellChangeTimes->{{3.8138423070170813`*^9, 3.813842320200165*^9}},
 FontSize->18,ExpressionUUID->"ce1b9402-a5f4-4d56-a343-7b0d4df54d0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElementDefinitions01", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Get", " ", "the", " ", "input", " ", "data"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Kd", ",", "\[Mu]", ",", "\[Gamma]", ",", "kp", ",", "\[Alpha]", ",", 
        "\[Rho]0"}], "}"}], "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"es$$", "[", 
          RowBox[{"\"\<Data\>\"", ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "SMSDomainDataNames", "]"}]}], "}"}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reference", " ", "coordinates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"XI", "\[RightTee]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SMSReal", "[", 
         RowBox[{"nd$$", "[", 
          RowBox[{"i", ",", "\"\<X\>\"", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "SMSNoNodes"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "SMSNoDimensions"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Get", " ", "the", " ", "full", " ", "displacemnets", " ", "and", " ", 
       "pressures"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"uI", "\[RightTee]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SMSReal", "[", 
         RowBox[{"nd$$", "[", 
          RowBox[{"i", ",", "\"\<at\>\"", ",", "j"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "22"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Split", " ", "into", " ", "displacements"}], ",", " ", 
       RowBox[{"velocities", " ", "and", " ", "accelerations"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"uIO1", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", " ", ";;", " ", "12"}], ",", "1"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", " ", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"uIO2", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"13", " ", ";;", " ", "22"}], ",", "1"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", " ", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vIO1", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", " ", ";;", " ", "12"}], ",", "4"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", " ", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"vIO2", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"13", " ", ";;", " ", "22"}], ",", "4"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", " ", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"aIO1", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", " ", ";;", " ", "12"}], ",", "5"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", " ", ",", "3"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"aIO2", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"uI", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"13", " ", ";;", " ", "22"}], ",", "5"}], "]"}], "]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", " ", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Separate", " ", "into", " ", "pressure", " ", "quantities"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"uT", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"SMSReal", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"uIO1", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "uIO2"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vT", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"SMSReal", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"vIO1", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "vIO2"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"aT", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"SMSReal", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"aIO1", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "2"}], "}"}]}], "]"}], "]"}], ",", "aIO2"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pT", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uIO1", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pvT", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"vIO1", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"paT", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"aIO1", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Define", " ", "flattened", " ", "vectors"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"pu", " ", "=", " ", 
      RowBox[{"Flatten", "[", "uT", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pv", " ", "=", " ", 
      RowBox[{"Flatten", "[", "vT", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pa", " ", "=", " ", 
      RowBox[{"Flatten", "[", "aT", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pp", " ", "=", " ", 
      RowBox[{"Flatten", "[", "pT", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppv", " ", "=", " ", 
      RowBox[{"Flatten", "[", "pvT", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppa", " ", "=", " ", 
      RowBox[{"Flatten", "[", "paT", "]"}]}], ";"}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8138423320528717`*^9, 3.813842376753051*^9}, {
   3.8138427027559633`*^9, 3.813842880905356*^9}, {3.813842955055373*^9, 
   3.813842955108612*^9}, {3.813843237325224*^9, 3.813843240229165*^9}, {
   3.813843714499749*^9, 3.813843719896337*^9}, {3.813843839085243*^9, 
   3.813843869836957*^9}, {3.813848143357772*^9, 3.813848160875143*^9}, {
   3.814569433945039*^9, 3.814569440363826*^9}, {3.8145695703431797`*^9, 
   3.8145695738481703`*^9}, {3.8145697156948967`*^9, 3.814569726031549*^9}, 
   3.814570661305429*^9, 3.814570722499826*^9, {3.814575184898939*^9, 
   3.814575226028874*^9}, {3.814575285175034*^9, 3.8145752917147503`*^9}, {
   3.814575479114863*^9, 3.814575516716139*^9}, {3.814620036511875*^9, 
   3.814620055078545*^9}, {3.8146201129384537`*^9, 3.814620184504889*^9}, {
   3.814723503056019*^9, 3.814723531163485*^9}, {3.814723705241722*^9, 
   3.814723710012397*^9}, {3.814723797822529*^9, 3.814723807436336*^9}, {
   3.814724330593072*^9, 3.814724343088152*^9}},
 FontSize->18,
 CellLabel->"In[4]:=",ExpressionUUID->"549448ee-4f4c-4fee-9585-c55497012894"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Element definition: Quadrature and shape functions", "Section",
 CellChangeTimes->{{3.813842889622016*^9, 3.813842900170743*^9}},
 FontSize->18,ExpressionUUID->"a71cb16a-1eff-4142-9c32-e2ef8bd45061"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElementDefinitions02", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Initialize", " ", "variable", " ", "for", " ", "Guass", " ", 
      "quadrature", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalXi]", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "\[Eta]"}], "}"}], "\[RightTee]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SMSReal", "[", 
          RowBox[{"es$$", "[", 
           RowBox[{"\"\<IntPoints\>\"", ",", "i", ",", "Ig"}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Define", " ", "the", " ", "weights", " ", "of", " ", "the", " ", 
       "integration", " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"wgp", "\[RightTee]", 
      RowBox[{"SMSReal", "[", 
       RowBox[{"es$$", "[", 
        RowBox[{"\"\<IntPoints\>\"", ",", "4", ",", "Ig"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Define", " ", "the", " ", "isoparametric", " ", "element"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[CapitalXi]n", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Define", " ", "the", " ", "shape", " ", "functions"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Nhp", "\[DoubleRightTee]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "4"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"\[CapitalXi]n", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Eta]", " ", 
            RowBox[{"\[CapitalXi]n", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Nhu", "\[DoubleRightTee]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1", "/", "4"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Xi]", "^", "2"}], "-", "\[Xi]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Eta]", "^", "2"}], "-", "\[Eta]"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "4"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Xi]", "^", "2"}], "+", "\[Xi]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Eta]", "^", "2"}], "-", "\[Eta]"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "4"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Xi]", "^", "2"}], "+", "\[Xi]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Eta]", "^", "2"}], "+", "\[Eta]"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "4"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Xi]", "^", "2"}], "-", "\[Xi]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Eta]", "^", "2"}], "+", "\[Eta]"}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Xi]", "^", "2"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Eta]", "^", "2"}], "-", "\[Eta]"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Xi]", "^", "2"}], "+", "\[Xi]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Xi]", "^", "2"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Eta]", "^", "2"}], "+", "\[Eta]"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Xi]", "^", "2"}], "-", "\[Xi]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Xi]", "^", "2"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[Eta]", "^", "2"}]}], ")"}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.813842921720272*^9, 3.813842978440011*^9}, {
  3.814569581483317*^9, 3.81456958488684*^9}, {3.814723197060499*^9, 
  3.81472319852131*^9}, {3.81472325471174*^9, 3.814723472528469*^9}},
 FontSize->18,
 CellLabel->"In[5]:=",ExpressionUUID->"4f961c8e-9638-4a01-a682-c83f9803a3df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Element definition: Interpolation of positions & pressures", "Section",
 CellChangeTimes->{{3.813842985505456*^9, 3.813842995805217*^9}, {
  3.813843346742887*^9, 3.813843348174974*^9}, {3.813848474678171*^9, 
  3.8138484765183887`*^9}},
 FontSize->18,ExpressionUUID->"094f8ccb-e91a-4ef8-845f-4f46d45fef89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElementDefinitions03", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Define", " ", "coordinates", " ", "at", " ", "the", " ", "Gauss", " ", 
      "point"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhu", ".", "XI"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Calculate", " ", "the", " ", "Jacobian"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"JX", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"X", ",", "\[CapitalXi]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Determinant", " ", "of", " ", "Jacobian"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"JXd", " ", "\[DoubleRightTee]", 
      RowBox[{"Det", "[", "JX", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Get", " ", 
       RowBox[{
        RowBox[{"disp", "/", "vel"}], "/", "acc"}], " ", "at", " ", "the", 
       " ", "Gauss", " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"u", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhu", ".", "uT"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhu", ".", "vT"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhu", ".", "aT"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Get", " ", "the", " ", "pressure", " ", "quantities", " ", "at", " ", 
       "the", " ", "Gauss", " ", "point"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"pr", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhp", ".", "pT"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prv", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhp", ".", "pvT"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pra", "\[RightTee]", 
      RowBox[{"SMSFreeze", "[", 
       RowBox[{"Nhp", ".", "paT"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Get", " ", "the", " ", "variation", " ", "of", " ", "u", " ", "and", 
       " ", "p"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]u", "\[RightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"u", ",", "pu"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Delta]p", "\[RightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"pr", ",", "pp"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"grad\[Delta]u", "\[RightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"Nhu", ",", "X", ",", 
        RowBox[{"\"\<Dependency\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]", ",", "X", ",", 
           RowBox[{"SMSInverse", "[", "JX", "]"}]}], "}"}]}]}], "]"}]}], 
     ";"}], "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.813843016625742*^9, 3.8138430675252247`*^9}, {
  3.813843285075666*^9, 3.813843334644204*^9}, {3.813843669111916*^9, 
  3.813843727048768*^9}, {3.813844076615375*^9, 3.813844099964919*^9}, {
  3.8138479623732*^9, 3.813848126884426*^9}, {3.813982522146494*^9, 
  3.81398257067013*^9}, {3.813982614218009*^9, 3.8139826146210747`*^9}, {
  3.81398265051495*^9, 3.8139826732004967`*^9}, {3.8139830447544727`*^9, 
  3.813983051067403*^9}, {3.814016405375153*^9, 3.814016427223548*^9}, {
  3.8140165927070704`*^9, 3.814016612915956*^9}, {3.8145695870190773`*^9, 
  3.814569590511723*^9}, {3.814723596685948*^9, 3.814723601740468*^9}, {
  3.814723634333486*^9, 3.814723666149667*^9}},
 FontSize->18,
 CellLabel->"In[6]:=",ExpressionUUID->"1981227f-9d78-437c-a04b-937959417ee7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Variations, gradient, strain and stress", "Section",
 CellChangeTimes->{{3.813848418111809*^9, 3.813848421395294*^9}, {
  3.81387340600445*^9, 3.81387341485361*^9}},
 FontSize->18,ExpressionUUID->"1c38b0e5-ec87-488e-8aa9-5e8a4a423d41"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElementDefinitions04", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Displacement", " ", "gradient"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Du", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"u", ",", "X", ",", 
        RowBox[{"\"\<Dependency\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]", ",", "X", ",", 
           RowBox[{"SMSInverse", "[", "JX", "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Small", " ", "strain"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SMSFreeze", "[", 
      RowBox[{"\[Epsilon]", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Du", "+", 
          RowBox[{"Transpose", "[", "Du", "]"}]}], ")"}], "/", "2"}], ",", 
       RowBox[{"\"\<KeepStructure\>\"", "\[Rule]", "True"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Decompose", " ", "into", " ", "deviatoric", " ", "and", " ", 
       "volumetric", " ", "strain"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"SMSFreeze", "[", 
      RowBox[{"\[Theta]", ",", 
       RowBox[{
        RowBox[{"\[Epsilon]", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
        RowBox[{"\[Epsilon]", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SMSFreeze", "[", 
      RowBox[{"\[Epsilon]d", ",", 
       RowBox[{"\[Epsilon]", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}], "*", "\[Theta]", "*", 
         RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Define", " ", "stress"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sig0", "\[DoubleRightTee]", 
      RowBox[{
       RowBox[{"Kd", "*", "\[Theta]"}], "-", 
       RowBox[{"\[Alpha]", "*", "pr"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sig2", "\[DoubleRightTee]", 
      RowBox[{
       RowBox[{"2", "*", "\[Mu]", "*", "\[Epsilon]d"}], "+", 
       RowBox[{"sig0", "*", 
        RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigv", "\[DoubleRightTee]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sig2", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"sig2", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"sig2", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Gradient", " ", "of", " ", "velocity"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"gradv", " ", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"v", ",", "X", ",", 
        RowBox[{"\"\<Dependency\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]", ",", "X", ",", 
           RowBox[{"SMSInverse", "[", "JX", "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Divergence", " ", "of", " ", "velocity"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"divv", "\[DoubleRightTee]", 
      RowBox[{
       RowBox[{"gradv", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
       RowBox[{"gradv", "\[LeftDoubleBracket]", 
        RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Gradient", " ", "of", " ", "p"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"gradp", " ", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"pr", ",", "X", ",", 
        RowBox[{"\"\<Dependency\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]", ",", "X", ",", 
           RowBox[{"SMSInverse", "[", "JX", "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Gradient", " ", "of", " ", "variation", " ", "of", " ", "p"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"grad\[Delta]p", " ", "\[DoubleRightTee]", 
      RowBox[{"SMSD", "[", 
       RowBox[{"\[Delta]p", ",", "X", ",", 
        RowBox[{"\"\<Dependency\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[CapitalXi]", ",", "X", ",", 
           RowBox[{"SMSInverse", "[", "JX", "]"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Form", " ", "the", " ", "B"}], "-", "matrix", " ", "-", " ", 
       RowBox[{
       "Need", " ", "a", " ", "more", " ", "elegant", " ", "form", " ", 
        "here"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Delta]\[Epsilon]", "\[DoubleRightTee]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"5", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"6", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"7", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"8", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"9", ",", "1"}], "\[RightDoubleBracket]"}], ",", "0"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"5", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"6", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"7", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"8", ",", "2"}], "\[RightDoubleBracket]"}], ",", "0", ",", 
          
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"9", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"5", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"5", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"6", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"6", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"7", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"7", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"8", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"8", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"9", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"grad\[Delta]u", "\[LeftDoubleBracket]", 
           RowBox[{"9", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
       "}"}]}], ";"}], "\[IndentingNewLine]", ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8138484540224533`*^9, 3.8138484700745792`*^9}, {
  3.81384854256654*^9, 3.813848576256447*^9}, {3.8138486503769093`*^9, 
  3.813848677088488*^9}, {3.813848876775481*^9, 3.813848910597865*^9}, {
  3.813848966385826*^9, 3.813848974919779*^9}, {3.8138491473929462`*^9, 
  3.813849163871903*^9}, {3.813873221851372*^9, 3.8138732802750473`*^9}, {
  3.813873324016097*^9, 3.8138733919048347`*^9}, {3.813982296627068*^9, 
  3.81398229890974*^9}, {3.813984826339425*^9, 3.8139848267884417`*^9}, {
  3.814016627270528*^9, 3.814016682963655*^9}, {3.814016716945232*^9, 
  3.8140167642849073`*^9}, {3.81401688271177*^9, 3.8140169280575953`*^9}, {
  3.814017024448003*^9, 3.8140171058569107`*^9}, {3.8143008863308353`*^9, 
  3.814300902543763*^9}, {3.814569594328557*^9, 3.814569596752158*^9}, {
  3.814724360697919*^9, 3.8147243629172583`*^9}, {3.8147245129949427`*^9, 
  3.814724615564746*^9}},
 FontSize->18,
 CellLabel->"In[7]:=",ExpressionUUID->"a8c5d7d4-87e4-4b1b-b8bb-e2eb89fcb9ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Terms for the residual", "Section",
 CellChangeTimes->{{3.813873455337729*^9, 3.81387348452664*^9}},
 FontSize->18,ExpressionUUID->"0074e2a8-42bf-4549-b46e-910e7e90962c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElementDefinitions05", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T1", " ", "\[DoubleRightTee]", 
      RowBox[{"\[Rho]0", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Transpose", "[", "\[Delta]u", "]"}], ".", "a"}], ")"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"T2", "\[DoubleRightTee]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "\[Delta]\[Epsilon]", "]"}], ".", "sigv"}], 
       ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T3", "\[DoubleRightTee]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]", "*", "prv"}], "+", 
         RowBox[{"\[Alpha]", "*", "divv"}]}], ")"}], "*", 
       RowBox[{"(", "\[Delta]p", ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T4", "\[DoubleRightTee]", 
      RowBox[{"kp", "*", 
       RowBox[{
        RowBox[{"(", "grad\[Delta]p", ")"}], ".", 
        RowBox[{"(", "gradp", ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
    ")"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQzXfmwKukrDeOIdUvwDRL4t/3ILqiU/YjiF6mXfID
RF/QzvsDoreceu6eDKT1CqZ4gOirsfwXpwNpk3YRMJ2ZlH0HRM9YkQumX/5T
4p0JpFVMC8F0v3mrIIgOK9wgDKKDjn6zAtGNyjutQfRzqceeIHpq/7EAEM1z
vTAMRK9T0AgH0fGbGaJB9BFnlVgQ/WMNi/xKIG2121gJRL/rktUE0Z4tjmB6
S6Gr+HognRrSLQei2RSEDUD0hRkmxiDa7+4dCxBd8PuZNYhelfvfD0Tn3T3p
D6L/L1xncABI617gMwTRMku6PB8A6StN88F0aYTexW3ZQPtzisC0wlneJqac
N46rjcLANADsp7Ln
  "],
 FontSize->18,
 CellLabel->"In[8]:=",ExpressionUUID->"4f4ee4e6-72e8-4296-ab68-1d3bc6175b6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Residual and Tangent calculation", "Section",
 CellChangeTimes->{{3.813843079328302*^9, 3.8138430855250587`*^9}},
 FontSize->18,ExpressionUUID->"4f9cc765-f95b-49c3-bd58-46b4ef10bb89"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SMSStandardModule", "[", "\"\<Tangent and residual\>\"", "]"}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Start", " ", "loop", " ", "over", " ", "all", " ", "integration", " ", 
    "points"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSDo", "[", 
   RowBox[{"Ig", ",", "1", ",", 
    RowBox[{"SMSInteger", "[", 
     RowBox[{"es$$", "[", 
      RowBox[{"\"\<id\>\"", ",", "\"\<NoIntPoints\>\""}], "]"}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ElementDefinitions01", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ElementDefinitions02", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ElementDefinitions03", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ElementDefinitions04", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ElementDefinitions05", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rgv", "\[DoubleRightTee]", " ", 
   RowBox[{"JXd", "*", " ", "wgp", "*", 
    RowBox[{"(", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"T1", "+", "T2"}], ",", 
       RowBox[{"T3", "+", "T4"}]}], "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rg", "\[DoubleRightTee]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "19", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "20", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "21", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "22", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "11", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "12", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "13", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "14", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "15", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "16", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "17", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"Rgv", "\[LeftDoubleBracket]", "18", "\[RightDoubleBracket]"}]}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{
    RowBox[{"SMSResidualSign", " ", "Rg"}], ",", "p$$", ",", 
    RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pud", "\[DoubleRightTee]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pu", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pp", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pp", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pp", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "11", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "12", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "13", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "14", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "15", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "16", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "17", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pu", "\[LeftDoubleBracket]", "18", "\[RightDoubleBracket]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pvd", "\[DoubleRightTee]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppv", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppv", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "11", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "12", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "13", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "14", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "15", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "16", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "17", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pv", "\[LeftDoubleBracket]", "18", "\[RightDoubleBracket]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pad", "\[DoubleRightTee]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pa", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppa", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppa", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppa", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"ppa", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "9", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "11", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "12", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "13", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "14", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "15", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "16", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "17", "\[RightDoubleBracket]"}], 
     ",", 
     RowBox[{"pa", "\[LeftDoubleBracket]", "18", "\[RightDoubleBracket]"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kg", "\[DoubleRightTee]", 
   RowBox[{"SMSD", "[", 
    RowBox[{"Rg", ",", "Pud"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cg", "\[DoubleRightTee]", 
   RowBox[{"SMSD", "[", 
    RowBox[{"Rg", ",", "Pvd"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mg", "\[DoubleRightTee]", 
   RowBox[{"SMSD", "[", 
    RowBox[{"Rg", ",", "Pad"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"Kg", ",", "s$$", ",", 
    RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"Cg", ",", "c$$", ",", 
    RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSExport", "[", 
   RowBox[{"Mg", ",", "m$$", ",", 
    RowBox[{"\"\<AddIn\>\"", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SMSEndDo", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.813843101514209*^9, 3.81384319669543*^9}, {
   3.813848892030439*^9, 3.813848918954558*^9}, {3.813981928770162*^9, 
   3.813981933702997*^9}, {3.8140199637180767`*^9, 3.8140200134041348`*^9}, {
   3.814020054870721*^9, 3.814020085304887*^9}, {3.8140202258726187`*^9, 
   3.814020247155781*^9}, {3.8140202842068853`*^9, 3.8140202954573717`*^9}, {
   3.814023855041534*^9, 3.8140238801790667`*^9}, {3.814023913060876*^9, 
   3.814023956262537*^9}, 3.814033902186985*^9, {3.814064524947501*^9, 
   3.8140645250235567`*^9}, {3.814128778750654*^9, 3.8141288007584753`*^9}, {
   3.8141288773153543`*^9, 3.8141289170086*^9}, {3.8141289575419903`*^9, 
   3.8141289663123837`*^9}, {3.814133384711062*^9, 3.81413339327009*^9}, {
   3.814133618413247*^9, 3.8141336200455637`*^9}, {3.814133705791342*^9, 
   3.814133756201167*^9}, {3.814133806243855*^9, 3.814133809605888*^9}, {
   3.8142888196679363`*^9, 3.8142889221330757`*^9}, {3.8142890926858473`*^9, 
   3.814289127782542*^9}, {3.814290100140016*^9, 3.8142901188978863`*^9}, {
   3.8142901676008577`*^9, 3.814290246888567*^9}, {3.814290279523211*^9, 
   3.814290330332643*^9}, {3.814290497167185*^9, 3.814290542913767*^9}, {
   3.814290586938673*^9, 3.8142905930576887`*^9}, {3.8142906371562634`*^9, 
   3.814290641392027*^9}, {3.814569616373713*^9, 3.8145696318687468`*^9}, {
   3.81456966584411*^9, 3.814569679134575*^9}, {3.8147235457907047`*^9, 
   3.814723546478435*^9}, {3.814723674416545*^9, 3.814723675269512*^9}, {
   3.814724631376624*^9, 3.8147246324708767`*^9}, {3.814755496453442*^9, 
   3.814755584339321*^9}, {3.814758243969592*^9, 3.81475830177748*^9}, {
   3.8147585438677464`*^9, 3.8147585666465187`*^9}, {3.814758607585884*^9, 
   3.814758630261485*^9}},
 FontSize->18,
 CellLabel->"In[9]:=",ExpressionUUID->"789cb996-a919-4254-9972-bcb1bdcc7fd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SMSSession", "[", 
    RowBox[{"[", "34", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"SMSSession", "[", 
     RowBox[{"[", "34", "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<Splice\>\"", ",", "_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Rule", "[", 
      RowBox[{"\"\<Splice\>\"", ",", "\"\<SMTFEAPAj.mf\>\""}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.814029675460331*^9, 3.814029679152998*^9}, {
  3.814065150415406*^9, 3.8140651518529873`*^9}, {3.814065265004241*^9, 
  3.8140652723516006`*^9}, {3.814065338534709*^9, 3.814065342012804*^9}, {
  3.8141288256303577`*^9, 3.814128828075404*^9}, {3.814128973258088*^9, 
  3.814128977110536*^9}, {3.8141299836256437`*^9, 3.814129986696632*^9}, {
  3.814132900818533*^9, 3.8141329023617153`*^9}, {3.814132935651956*^9, 
  3.814132938634791*^9}, {3.81413360579978*^9, 3.8141336133373737`*^9}, {
  3.814133664746203*^9, 3.8141336679247417`*^9}, {3.814134096901266*^9, 
  3.814134100490532*^9}, {3.8145696402772303`*^9, 3.814569656213275*^9}, {
  3.814761712859475*^9, 3.8147617157066*^9}},
 FontSize->18,
 CellLabel->"In[29]:=",ExpressionUUID->"3bae8b07-6552-4fc3-abe8-fa4bd3efeb2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SMSWrite", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.814029683902101*^9, {3.814065148525612*^9, 3.814065149994444*^9}, {
   3.814065267344488*^9, 3.8140652701471567`*^9}, {3.8140653395234203`*^9, 
   3.814065340212381*^9}, {3.8141288210135593`*^9, 3.814128823453817*^9}, {
   3.814128974400188*^9, 3.814128975269434*^9}, {3.814129989400097*^9, 
   3.814129991936172*^9}, {3.814132894117566*^9, 3.814132900366117*^9}, {
   3.8141336076569*^9, 3.814133610852857*^9}, {3.814134098007976*^9, 
   3.8141340987482243`*^9}, 3.8145696600099783`*^9, {3.814761713784013*^9, 
   3.8147617146247597`*^9}},
 FontSize->18,
 CellLabel->"In[30]:=",ExpressionUUID->"e22ea539-ce2d-4368-b154-5459f10be939"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     TemplateBox[{
       StyleBox["\"File: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "\"PoroTH_v1.f\"", 
       StyleBox["\"  Size: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "72708", 
       StyleBox["\"  Time: \"", Bold, 
        RGBColor[0, 0, 1], StripOnInput -> False], "31"},
      "RowDefault"]},
    {
     TagBox[GridBox[{
        {
         StyleBox["\<\"Method\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], 
         StyleBox["\<\"SKR10\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontColor->RGBColor[0, 0, 1]]},
        {
         StyleBox["\<\"No.Formulae\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "502"},
        {
         StyleBox["\<\"No.Leafs\"\>",
          StripOnInput->False,
          LineColor->RGBColor[0, 0, 1],
          FrontFaceColor->RGBColor[0, 0, 1],
          BackFaceColor->RGBColor[0, 0, 1],
          GraphicsColor->RGBColor[0, 0, 1],
          FontWeight->Bold,
          FontColor->RGBColor[0, 0, 1]], "19989"}
       },
       AutoDelete->False,
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Center}}},
       GridBoxDividers->{"Columns" -> {True, True}},
       GridBoxFrame->{"ColumnsIndexed" -> {{{1, -1}, {1, -1}} -> True}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      "Grid"]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxDividers->{"Rows" -> {True, True}},
   GridBoxFrame->{"Columns" -> False, "Rows" -> False},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{3.81476173926541*^9, 3.814761779049163*^9, 
  3.814806910801599*^9, 3.814882496603746*^9, 3.8148841859890842`*^9, 
  3.8148844307224007`*^9, 3.814905211451294*^9, 3.8149056182421017`*^9, 
  3.814905730971025*^9, 3.814905851650607*^9, 3.814905889575735*^9, 
  3.814906067342002*^9, 3.8149743996621847`*^9, 3.815240085113903*^9, 
  3.8153411605081043`*^9, 3.815341203540238*^9, 3.8153416124722443`*^9, 
  3.815371066987982*^9},
 CellLabel->
  "During evaluation of \
In[30]:=",ExpressionUUID->"efe5417a-a4cc-4337-85cd-82a2cb02dcb9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1306, 1306},
WindowMargins->{{Automatic, -383}, {981, Automatic}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 18, 2020)",
StyleDefinitions->FrontEnd`FileName[{"AceStyles"}, "AceStyle.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"a20e1ce7-d8b8-4714-a343-2eacd88f2555"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 172, 2, 63, "Title",ExpressionUUID->"ae2105f6-22e3-4fc6-a8c7-18940e5d6e3f"],
Cell[CellGroupData[{
Cell[777, 28, 171, 2, 58, "Section",ExpressionUUID->"8ab5073c-1a9a-42f8-8a12-b859b69c83b8"],
Cell[951, 32, 2394, 52, 413, "Input",ExpressionUUID->"d48f5ec4-4493-44eb-85e7-d95bc4a4b323"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3382, 89, 199, 2, 58, "Section",ExpressionUUID->"ce1b9402-a5f4-4d56-a343-7b0d4df54d0b"],
Cell[3584, 93, 9661, 238, 848, "Input",ExpressionUUID->"549448ee-4f4c-4fee-9585-c55497012894"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13282, 336, 205, 2, 58, "Section",ExpressionUUID->"a71cb16a-1eff-4142-9c32-e2ef8bd45061"],
Cell[13490, 340, 5599, 154, 384, "Input",ExpressionUUID->"4f961c8e-9638-4a01-a682-c83f9803a3df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19126, 499, 313, 4, 58, "Section",ExpressionUUID->"094f8ccb-e91a-4ef8-845f-4f46d45fef89"],
Cell[19442, 505, 3860, 82, 594, "Input",ExpressionUUID->"1981227f-9d78-437c-a04b-937959417ee7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23339, 592, 241, 3, 58, "Section",ExpressionUUID->"1c38b0e5-ec87-488e-8aa9-5e8a4a423d41"],
Cell[23583, 597, 11372, 232, 848, "Input",ExpressionUUID->"a8c5d7d4-87e4-4b1b-b8bb-e2eb89fcb9ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34992, 834, 176, 2, 58, "Section",ExpressionUUID->"0074e2a8-42bf-4549-b46e-910e7e90962c"],
Cell[35171, 838, 1602, 40, 181, "Input",ExpressionUUID->"4f4ee4e6-72e8-4296-ab68-1d3bc6175b6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36810, 883, 189, 2, 58, "Section",ExpressionUUID->"4f9cc765-f95b-49c3-bd58-46b4ef10bb89"],
Cell[37002, 887, 12490, 287, 732, "Input",ExpressionUUID->"789cb996-a919-4254-9972-bcb1bdcc7fd4"],
Cell[49495, 1176, 1228, 25, 35, "Input",ExpressionUUID->"3bae8b07-6552-4fc3-abe8-fa4bd3efeb2e"],
Cell[CellGroupData[{
Cell[50748, 1205, 733, 13, 35, "Input",ExpressionUUID->"e22ea539-ce2d-4368-b154-5459f10be939"],
Cell[51484, 1220, 2837, 70, 86, "Print",ExpressionUUID->"efe5417a-a4cc-4337-85cd-82a2cb02dcb9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

